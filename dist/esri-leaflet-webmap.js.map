{"version":3,"file":null,"sources":["../node_modules/arcgis-to-geojson-utils/index.js","../node_modules/esri-leaflet-renderers/src/Symbols/PointSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/LineSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/PolygonSymbol.js","../node_modules/esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/UniqueValueRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/SimpleRenderer.js","../src/FeatureCollection/Renderer.js","../src/FeatureCollection/FeatureCollection.js","../src/FeatureCollection/CSVLayer.js","../src/FeatureCollection/KMLLayer.js","../src/Label/LabelIcon.js","../src/Label/LabelMarker.js","../src/Label/PointLabel.js","../src/Label/PolylineLabel.js","../src/Label/PolygonLabel.js","../node_modules/date-fns/format/index.js","../src/Popup/Popup.js","../src/OperationalLayer.js","../src/WebMapLoader.js","../node_modules/esri-leaflet-renderers/src/Symbols/Symbol.js","../node_modules/leaflet-shape-markers/src/ShapeMarker.js","../node_modules/leaflet-shape-markers/src/CrossMarker.js","../node_modules/leaflet-shape-markers/src/XMarker.js","../node_modules/leaflet-shape-markers/src/SquareMarker.js","../node_modules/leaflet-shape-markers/src/DiamondMarker.js","../node_modules/esri-leaflet-renderers/src/Renderers/Renderer.js"],"sourcesContent":["/*\n * Copyright 2017 Esri\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// checks if 2 x,y points are equal\nfunction pointsEqual (a, b) {\n  for (var i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// checks if the first and last points of a ring are equal and closes the ring\nfunction closeRing (coordinates) {\n  if (!pointsEqual(coordinates[0], coordinates[coordinates.length - 1])) {\n    coordinates.push(coordinates[0]);\n  }\n  return coordinates;\n}\n\n// determine if polygon ring coordinates are clockwise. clockwise signifies outer ring, counter-clockwise an inner ring\n// or hole. this logic was found at http://stackoverflow.com/questions/1165647/how-to-determine-if-a-list-of-polygon-\n// points-are-in-clockwise-order\nfunction ringIsClockwise (ringToTest) {\n  var total = 0;\n  var i = 0;\n  var rLength = ringToTest.length;\n  var pt1 = ringToTest[i];\n  var pt2;\n  for (i; i < rLength - 1; i++) {\n    pt2 = ringToTest[i + 1];\n    total += (pt2[0] - pt1[0]) * (pt2[1] + pt1[1]);\n    pt1 = pt2;\n  }\n  return (total >= 0);\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L504-L519\nfunction vertexIntersectsVertex (a1, a2, b1, b2) {\n  var uaT = ((b2[0] - b1[0]) * (a1[1] - b1[1])) - ((b2[1] - b1[1]) * (a1[0] - b1[0]));\n  var ubT = ((a2[0] - a1[0]) * (a1[1] - b1[1])) - ((a2[1] - a1[1]) * (a1[0] - b1[0]));\n  var uB = ((b2[1] - b1[1]) * (a2[0] - a1[0])) - ((b2[0] - b1[0]) * (a2[1] - a1[1]));\n\n  if (uB !== 0) {\n    var ua = uaT / uB;\n    var ub = ubT / uB;\n\n    if (ua >= 0 && ua <= 1 && ub >= 0 && ub <= 1) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L521-L531\nfunction arrayIntersectsArray (a, b) {\n  for (var i = 0; i < a.length - 1; i++) {\n    for (var j = 0; j < b.length - 1; j++) {\n      if (vertexIntersectsVertex(a[i], a[i + 1], b[j], b[j + 1])) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L470-L480\nfunction coordinatesContainPoint (coordinates, point) {\n  var contains = false;\n  for (var i = -1, l = coordinates.length, j = l - 1; ++i < l; j = i) {\n    if (((coordinates[i][1] <= point[1] && point[1] < coordinates[j][1]) ||\n         (coordinates[j][1] <= point[1] && point[1] < coordinates[i][1])) &&\n        (point[0] < (((coordinates[j][0] - coordinates[i][0]) * (point[1] - coordinates[i][1])) / (coordinates[j][1] - coordinates[i][1])) + coordinates[i][0])) {\n      contains = !contains;\n    }\n  }\n  return contains;\n}\n\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L106-L113\nfunction coordinatesContainCoordinates (outer, inner) {\n  var intersects = arrayIntersectsArray(outer, inner);\n  var contains = coordinatesContainPoint(outer, inner[0]);\n  if (!intersects && contains) {\n    return true;\n  }\n  return false;\n}\n\n// do any polygons in this array contain any other polygons in this array?\n// used for checking for holes in arcgis rings\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L117-L172\nfunction convertRingsToGeoJSON (rings) {\n  var outerRings = [];\n  var holes = [];\n  var x; // iterator\n  var outerRing; // current outer ring being evaluated\n  var hole; // current hole being evaluated\n\n  // for each ring\n  for (var r = 0; r < rings.length; r++) {\n    var ring = closeRing(rings[r].slice(0));\n    if (ring.length < 4) {\n      continue;\n    }\n    // is this ring an outer ring? is it clockwise?\n    if (ringIsClockwise(ring)) {\n      var polygon = [ ring ];\n      outerRings.push(polygon); // push to outer rings\n    } else {\n      holes.push(ring); // counterclockwise push to holes\n    }\n  }\n\n  var uncontainedHoles = [];\n\n  // while there are holes left...\n  while (holes.length) {\n    // pop a hole off out stack\n    hole = holes.pop();\n\n    // loop over all outer rings and see if they contain our hole.\n    var contained = false;\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (coordinatesContainCoordinates(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        contained = true;\n        break;\n      }\n    }\n\n    // ring is not contained in any outer ring\n    // sometimes this happens https://github.com/Esri/esri-leaflet/issues/320\n    if (!contained) {\n      uncontainedHoles.push(hole);\n    }\n  }\n\n  // if we couldn't match any holes using contains we can try intersects...\n  while (uncontainedHoles.length) {\n    // pop a hole off out stack\n    hole = uncontainedHoles.pop();\n\n    // loop over all outer rings and see if any intersect our hole.\n    var intersects = false;\n\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (arrayIntersectsArray(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        intersects = true;\n        break;\n      }\n    }\n\n    if (!intersects) {\n      outerRings.push([hole.reverse()]);\n    }\n  }\n\n  if (outerRings.length === 1) {\n    return {\n      type: 'Polygon',\n      coordinates: outerRings[0]\n    };\n  } else {\n    return {\n      type: 'MultiPolygon',\n      coordinates: outerRings\n    };\n  }\n}\n\n// This function ensures that rings are oriented in the right directions\n// outer rings are clockwise, holes are counterclockwise\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction orientRings (poly) {\n  var output = [];\n  var polygon = poly.slice(0);\n  var outerRing = closeRing(polygon.shift().slice(0));\n  if (outerRing.length >= 4) {\n    if (!ringIsClockwise(outerRing)) {\n      outerRing.reverse();\n    }\n\n    output.push(outerRing);\n\n    for (var i = 0; i < polygon.length; i++) {\n      var hole = closeRing(polygon[i].slice(0));\n      if (hole.length >= 4) {\n        if (ringIsClockwise(hole)) {\n          hole.reverse();\n        }\n        output.push(hole);\n      }\n    }\n  }\n\n  return output;\n}\n\n// This function flattens holes in multipolygons to one array of polygons\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction flattenMultiPolygonRings (rings) {\n  var output = [];\n  for (var i = 0; i < rings.length; i++) {\n    var polygon = orientRings(rings[i]);\n    for (var x = polygon.length - 1; x >= 0; x--) {\n      var ring = polygon[x].slice(0);\n      output.push(ring);\n    }\n  }\n  return output;\n}\n\n// shallow object clone for feature properties and attributes\n// from http://jsperf.com/cloning-an-object/2\nfunction shallowClone (obj) {\n  var target = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      target[i] = obj[i];\n    }\n  }\n  return target;\n}\n\nexport function arcgisToGeoJSON (arcgis, idAttribute) {\n  var geojson = {};\n\n  if (typeof arcgis.x === 'number' && typeof arcgis.y === 'number') {\n    geojson.type = 'Point';\n    geojson.coordinates = [arcgis.x, arcgis.y];\n  }\n\n  if (arcgis.points) {\n    geojson.type = 'MultiPoint';\n    geojson.coordinates = arcgis.points.slice(0);\n  }\n\n  if (arcgis.paths) {\n    if (arcgis.paths.length === 1) {\n      geojson.type = 'LineString';\n      geojson.coordinates = arcgis.paths[0].slice(0);\n    } else {\n      geojson.type = 'MultiLineString';\n      geojson.coordinates = arcgis.paths.slice(0);\n    }\n  }\n\n  if (arcgis.rings) {\n    geojson = convertRingsToGeoJSON(arcgis.rings.slice(0));\n  }\n\n  if (arcgis.geometry || arcgis.attributes) {\n    geojson.type = 'Feature';\n    geojson.geometry = (arcgis.geometry) ? arcgisToGeoJSON(arcgis.geometry) : null;\n    geojson.properties = (arcgis.attributes) ? shallowClone(arcgis.attributes) : null;\n    if (arcgis.attributes) {\n      geojson.id = arcgis.attributes[idAttribute] || arcgis.attributes.OBJECTID || arcgis.attributes.FID;\n    }\n  }\n\n  // if no valid geometry was encountered\n  if (JSON.stringify(geojson.geometry) === JSON.stringify({})) {\n    geojson.geometry = null;\n  }\n\n  return geojson;\n}\n\nexport function geojsonToArcGIS (geojson, idAttribute) {\n  idAttribute = idAttribute || 'OBJECTID';\n  var spatialReference = { wkid: 4326 };\n  var result = {};\n  var i;\n\n  switch (geojson.type) {\n    case 'Point':\n      result.x = geojson.coordinates[0];\n      result.y = geojson.coordinates[1];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPoint':\n      result.points = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'LineString':\n      result.paths = [geojson.coordinates.slice(0)];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiLineString':\n      result.paths = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'Polygon':\n      result.rings = orientRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPolygon':\n      result.rings = flattenMultiPolygonRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'Feature':\n      if (geojson.geometry) {\n        result.geometry = geojsonToArcGIS(geojson.geometry, idAttribute);\n      }\n      result.attributes = (geojson.properties) ? shallowClone(geojson.properties) : {};\n      if (geojson.id) {\n        result.attributes[idAttribute] = geojson.id;\n      }\n      break;\n    case 'FeatureCollection':\n      result = [];\n      for (i = 0; i < geojson.features.length; i++) {\n        result.push(geojsonToArcGIS(geojson.features[i], idAttribute));\n      }\n      break;\n    case 'GeometryCollection':\n      result = [];\n      for (i = 0; i < geojson.geometries.length; i++) {\n        result.push(geojsonToArcGIS(geojson.geometries[i], idAttribute));\n      }\n      break;\n  }\n\n  return result;\n}\n\nexport default { arcgisToGeoJSON, geojsonToArcGIS };\n","import L from 'leaflet';\nimport Symbol from './Symbol';\nimport {squareMarker, xMarker, crossMarker, diamondMarker} from 'leaflet-shape-markers';\n\nexport var PointSymbol = Symbol.extend({\n\n  statics: {\n    MARKERTYPES: ['esriSMSCircle', 'esriSMSCross', 'esriSMSDiamond', 'esriSMSSquare', 'esriSMSX', 'esriPMS']\n  },\n\n  initialize: function (symbolJson, options) {\n    var url;\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (options) {\n      this.serviceUrl = options.url;\n    }\n    if (symbolJson) {\n      if (symbolJson.type === 'esriPMS') {\n        var imageUrl = this._symbolJson.url;\n        if ((imageUrl && imageUrl.substr(0, 7) === 'http://') || (imageUrl.substr(0, 8) === 'https://')) {\n          // web image\n          url = this.sanitize(imageUrl);\n          this._iconUrl = url;\n        } else {\n          url = this.serviceUrl + 'images/' + imageUrl;\n          this._iconUrl = options && options.token ? url + '?token=' + options.token : url;\n        }\n        if (symbolJson.imageData) {\n          this._iconUrl = 'data:' + symbolJson.contentType + ';base64,' + symbolJson.imageData;\n        }\n        // leaflet does not allow resizing icons so keep a hash of different\n        // icon sizes to try and keep down on the number of icons created\n        this._icons = {};\n        // create base icon\n        this.icon = this._createIcon(this._symbolJson);\n      } else {\n        this._fillStyles();\n      }\n    }\n  },\n\n  // prevent html injection in strings\n  sanitize: function (str) {\n    if (!str) {\n      return '';\n    }\n    var text;\n    try {\n      // removes html but leaves url link text\n      text = str.replace(/<br>/gi, '\\n');\n      text = text.replace(/<p.*>/gi, '\\n');\n      text = text.replace(/<a.*href='(.*?)'.*>(.*?)<\\/a>/gi, ' $2 ($1) ');\n      text = text.replace(/<(?:.|\\s)*?>/g, '');\n    } catch (ex) {\n      text = null;\n    }\n    return text;\n  },\n\n  _fillStyles: function () {\n    if (this._symbolJson.outline && this._symbolJson.size > 0 && this._symbolJson.outline.style !== 'esriSLSNull') {\n      this._styles.stroke = true;\n      this._styles.weight = this.pixelValue(this._symbolJson.outline.width);\n      this._styles.color = this.colorValue(this._symbolJson.outline.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.outline.color);\n    } else {\n      this._styles.stroke = false;\n    }\n    if (this._symbolJson.color) {\n      this._styles.fillColor = this.colorValue(this._symbolJson.color);\n      this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n    } else {\n      this._styles.fillOpacity = 0;\n    }\n\n    if (this._symbolJson.style === 'esriSMSCircle') {\n      this._styles.radius = this.pixelValue(this._symbolJson.size) / 2.0;\n    }\n  },\n\n  _createIcon: function (options) {\n    var width = this.pixelValue(options.width);\n    var height = width;\n    if (options.height) {\n      height = this.pixelValue(options.height);\n    }\n    var xOffset = width / 2.0;\n    var yOffset = height / 2.0;\n\n    if (options.xoffset) {\n      xOffset += this.pixelValue(options.xoffset);\n    }\n    if (options.yoffset) {\n      yOffset += this.pixelValue(options.yoffset);\n    }\n\n    var icon = L.icon({\n      iconUrl: this._iconUrl,\n      iconSize: [width, height],\n      iconAnchor: [xOffset, yOffset]\n    });\n    this._icons[options.width.toString()] = icon;\n    return icon;\n  },\n\n  _getIcon: function (size) {\n    // check to see if it is already created by size\n    var icon = this._icons[size.toString()];\n    if (!icon) {\n      icon = this._createIcon({width: size});\n    }\n    return icon;\n  },\n\n  pointToLayer: function (geojson, latlng, visualVariables, options) {\n    var size = this._symbolJson.size || this._symbolJson.width;\n    if (!this._isDefault) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.getSize(geojson, visualVariables.sizeInfo);\n        if (calculatedSize) {\n          size = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(geojson, visualVariables.colorInfo);\n        if (color) {\n          this._styles.fillColor = this.colorValue(color);\n          this._styles.fillOpacity = this.alphaValue(color);\n        }\n      }\n    }\n\n    if (this._symbolJson.type === 'esriPMS') {\n      var layerOptions = L.extend({}, {icon: this._getIcon(size)}, options);\n      return L.marker(latlng, layerOptions);\n    }\n    size = this.pixelValue(size);\n\n    switch (this._symbolJson.style) {\n      case 'esriSMSSquare':\n        return squareMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSDiamond':\n        return diamondMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSCross':\n        return crossMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSX':\n        return xMarker(latlng, size, L.extend({}, this._styles, options));\n    }\n    this._styles.radius = size / 2.0;\n    return L.circleMarker(latlng, L.extend({}, this._styles, options));\n  }\n});\n\nexport function pointSymbol (symbolJson, options) {\n  return new PointSymbol(symbolJson, options);\n}\n\nexport default pointSymbol;\n","import Symbol from './Symbol';\n\nexport var LineSymbol = Symbol.extend({\n  statics: {\n    // Not implemented 'esriSLSNull'\n    LINETYPES: ['esriSLSDash', 'esriSLSDot', 'esriSLSDashDotDot', 'esriSLSDashDot', 'esriSLSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    this._fillStyles();\n  },\n\n  _fillStyles: function () {\n    // set the defaults that show up on arcgis online\n    this._styles.lineCap = 'butt';\n    this._styles.lineJoin = 'miter';\n    this._styles.fill = false;\n    this._styles.weight = 0;\n\n    if (!this._symbolJson) {\n      return this._styles;\n    }\n\n    if (this._symbolJson.color) {\n      this._styles.color = this.colorValue(this._symbolJson.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.color);\n    }\n\n    if (!isNaN(this._symbolJson.width)) {\n      this._styles.weight = this.pixelValue(this._symbolJson.width);\n\n      var dashValues = [];\n\n      switch (this._symbolJson.style) {\n        case 'esriSLSDash':\n          dashValues = [4, 3];\n          break;\n        case 'esriSLSDot':\n          dashValues = [1, 3];\n          break;\n        case 'esriSLSDashDot':\n          dashValues = [8, 3, 1, 3];\n          break;\n        case 'esriSLSDashDotDot':\n          dashValues = [8, 3, 1, 3, 1, 3];\n          break;\n      }\n\n      // use the dash values and the line weight to set dash array\n      if (dashValues.length > 0) {\n        for (var i = 0; i < dashValues.length; i++) {\n          dashValues[i] *= this._styles.weight;\n        }\n\n        this._styles.dashArray = dashValues.join(',');\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.pixelValue(this.getSize(feature, visualVariables.sizeInfo));\n        if (calculatedSize) {\n          this._styles.weight = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(feature, visualVariables.colorInfo);\n        if (color) {\n          this._styles.color = this.colorValue(color);\n          this._styles.opacity = this.alphaValue(color);\n        }\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function lineSymbol (symbolJson, options) {\n  return new LineSymbol(symbolJson, options);\n}\n\nexport default lineSymbol;\n","import Symbol from './Symbol';\nimport lineSymbol from './LineSymbol';\n\nexport var PolygonSymbol = Symbol.extend({\n  statics: {\n    // not implemented: 'esriSFSBackwardDiagonal','esriSFSCross','esriSFSDiagonalCross','esriSFSForwardDiagonal','esriSFSHorizontal','esriSFSNull','esriSFSVertical'\n    POLYGONTYPES: ['esriSFSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (symbolJson) {\n      if (symbolJson.outline && symbolJson.outline.style === 'esriSLSNull') {\n        this._lineStyles = { weight: 0 };\n      } else {\n        this._lineStyles = lineSymbol(symbolJson.outline, options).style();\n      }\n      this._fillStyles();\n    }\n  },\n\n  _fillStyles: function () {\n    if (this._lineStyles) {\n      if (this._lineStyles.weight === 0) {\n        // when weight is 0, setting the stroke to false can still look bad\n        // (gaps between the polygons)\n        this._styles.stroke = false;\n      } else {\n        // copy the line symbol styles into this symbol's styles\n        for (var styleAttr in this._lineStyles) {\n          this._styles[styleAttr] = this._lineStyles[styleAttr];\n        }\n      }\n    }\n\n    // set the fill for the polygon\n    if (this._symbolJson) {\n      if (this._symbolJson.color &&\n          // don't fill polygon if type is not supported\n          PolygonSymbol.POLYGONTYPES.indexOf(this._symbolJson.style >= 0)) {\n        this._styles.fill = true;\n        this._styles.fillColor = this.colorValue(this._symbolJson.color);\n        this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n      } else {\n        this._styles.fill = false;\n        this._styles.fillOpacity = 0;\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables && visualVariables.colorInfo) {\n      var color = this.getColor(feature, visualVariables.colorInfo);\n      if (color) {\n        this._styles.fillColor = this.colorValue(color);\n        this._styles.fillOpacity = this.alphaValue(color);\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function polygonSymbol (symbolJson, options) {\n  return new PolygonSymbol(symbolJson, options);\n}\n\nexport default polygonSymbol;\n","import Renderer from './Renderer';\n\nexport var ClassBreaksRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field;\n    if (this._rendererJson.normalizationType && this._rendererJson.normalizationType === 'esriNormalizeByField') {\n      this._normalizationField = this._rendererJson.normalizationField;\n    }\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var classbreaks = this._rendererJson.classBreakInfos;\n\n    this._symbols = [];\n\n    // create a symbol for each class break\n    for (var i = classbreaks.length - 1; i >= 0; i--) {\n      if (this.options.proportionalPolygon && this._rendererJson.backgroundFillSymbol) {\n        symbol = this._newSymbol(this._rendererJson.backgroundFillSymbol);\n      } else {\n        symbol = this._newSymbol(classbreaks[i].symbol);\n      }\n      symbol.val = classbreaks[i].classMaxValue;\n      this._symbols.push(symbol);\n    }\n    // sort the symbols in ascending value\n    this._symbols.sort(function (a, b) {\n      return a.val > b.val ? 1 : -1;\n    });\n    this._createDefaultSymbol();\n    this._maxValue = this._symbols[this._symbols.length - 1].val;\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    if (this._normalizationField) {\n      var normValue = feature.properties[this._normalizationField];\n      if (!isNaN(normValue) && normValue !== 0) {\n        val = val / normValue;\n      } else {\n        return this._defaultSymbol;\n      }\n    }\n\n    if (val > this._maxValue) {\n      return this._defaultSymbol;\n    }\n    var symbol = this._symbols[0];\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      if (val > this._symbols[i].val) {\n        break;\n      }\n      symbol = this._symbols[i];\n    }\n    return symbol;\n  }\n});\n\nexport function classBreaksRenderer (rendererJson, options) {\n  return new ClassBreaksRenderer(rendererJson, options);\n}\n\nexport default classBreaksRenderer;\n","import Renderer from './Renderer';\n\nexport var UniqueValueRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field1;\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var uniques = this._rendererJson.uniqueValueInfos;\n\n    // create a symbol for each unique value\n    for (var i = uniques.length - 1; i >= 0; i--) {\n      symbol = this._newSymbol(uniques[i].symbol);\n      symbol.val = uniques[i].value;\n      this._symbols.push(symbol);\n    }\n    this._createDefaultSymbol();\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    // accumulate values if there is more than one field defined\n    if (this._rendererJson.fieldDelimiter && this._rendererJson.field2) {\n      var val2 = feature.properties[this._rendererJson.field2];\n      if (val2) {\n        val += this._rendererJson.fieldDelimiter + val2;\n        var val3 = feature.properties[this._rendererJson.field3];\n        if (val3) {\n          val += this._rendererJson.fieldDelimiter + val3;\n        }\n      }\n    }\n\n    var symbol = this._defaultSymbol;\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      // using the === operator does not work if the field\n      // of the unique renderer is not a string\n      /*eslint-disable */\n      if (this._symbols[i].val == val) {\n        symbol = this._symbols[i];\n      }\n      /*eslint-enable */\n    }\n    return symbol;\n  }\n});\n\nexport function uniqueValueRenderer (rendererJson, options) {\n  return new UniqueValueRenderer(rendererJson, options);\n}\n\nexport default uniqueValueRenderer;\n","import Renderer from './Renderer';\n\nexport var SimpleRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._createSymbol();\n  },\n\n  _createSymbol: function () {\n    if (this._rendererJson.symbol) {\n      this._symbols.push(this._newSymbol(this._rendererJson.symbol));\n    }\n  },\n\n  _getSymbol: function () {\n    return this._symbols[0];\n  }\n});\n\nexport function simpleRenderer (rendererJson, options) {\n  return new SimpleRenderer(rendererJson, options);\n}\n\nexport default simpleRenderer;\n","import { classBreaksRenderer } from 'esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer';\r\nimport { uniqueValueRenderer } from 'esri-leaflet-renderers/src/Renderers/UniqueValueRenderer';\r\nimport { simpleRenderer } from 'esri-leaflet-renderers/src/Renderers/SimpleRenderer';\r\n\r\nexport function setRenderer (layerDefinition, layer) {\r\n  var rend;\r\n  var rendererInfo = layerDefinition.drawingInfo.renderer;\r\n\r\n  var options = {};\r\n\r\n  if (layer.options.pane) {\r\n    options.pane = layer.options.pane;\r\n  }\r\n  if (layerDefinition.drawingInfo.transparency) {\r\n    options.layerTransparency = layerDefinition.drawingInfo.transparency;\r\n  }\r\n  if (layer.options.style) {\r\n    options.userDefinedStyle = layer.options.style;\r\n  }\r\n\r\n  switch (rendererInfo.type) {\r\n    case 'classBreaks':\r\n      checkForProportionalSymbols(layerDefinition.geometryType, rendererInfo, layer);\r\n      if (layer._hasProportionalSymbols) {\r\n        layer._createPointLayer();\r\n        var pRend = classBreaksRenderer(rendererInfo, options);\r\n        pRend.attachStylesToLayer(layer._pointLayer);\r\n        options.proportionalPolygon = true;\r\n      }\r\n      rend = classBreaksRenderer(rendererInfo, options);\r\n      break;\r\n    case 'uniqueValue':\r\n      console.log(rendererInfo, options);\r\n      rend = uniqueValueRenderer(rendererInfo, options);\r\n      break;\r\n    default:\r\n      rend = simpleRenderer(rendererInfo, options);\r\n  }\r\n  rend.attachStylesToLayer(layer);\r\n}\r\n\r\nexport function checkForProportionalSymbols (geometryType, renderer, layer) {\r\n  layer._hasProportionalSymbols = false;\r\n  if (geometryType === 'esriGeometryPolygon') {\r\n    if (renderer.backgroundFillSymbol) {\r\n      layer._hasProportionalSymbols = true;\r\n    }\r\n    // check to see if the first symbol in the classbreaks is a marker symbol\r\n    if (renderer.classBreakInfos && renderer.classBreakInfos.length) {\r\n      var sym = renderer.classBreakInfos[0].symbol;\r\n      if (sym && (sym.type === 'esriSMS' || sym.type === 'esriPMS')) {\r\n        layer._hasProportionalSymbols = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport var Renderer = {\r\n  setRenderer: setRenderer,\r\n  checkForProportionalSymbols: checkForProportionalSymbols\r\n};\r\n\r\nexport default Renderer;\r\n","import L from 'leaflet';\r\n\r\nimport { arcgisToGeoJSON } from 'arcgis-to-geojson-utils';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var FeatureCollection = L.GeoJSON.extend({\r\n  options: {\r\n    data: {}, // Esri Feature Collection JSON or Item ID\r\n    opacity: 1\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.data = this.options.data;\r\n    this.opacity = this.options.opacity;\r\n    this.popupInfo = null;\r\n    this.labelingInfo = null;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    if (typeof this.data === 'string') {\r\n      this._getFeatureCollection(this.data);\r\n    } else {\r\n      this._parseFeatureCollection(this.data);\r\n    }\r\n  },\r\n\r\n  _getFeatureCollection: function (itemId) {\r\n    var url = 'https://www.arcgis.com/sharing/rest/content/items/' + itemId + '/data';\r\n    L.esri.request(url, {}, function (err, res) {\r\n      if (err) {\r\n        console.log(err);\r\n      } else {\r\n        this._parseFeatureCollection(res);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  _parseFeatureCollection: function (data) {\r\n    var i, len;\r\n    var index = 0;\r\n    for (i = 0, len = data.layers.length; i < len; i++) {\r\n      if (data.layers[i].featureSet.features.length > 0) {\r\n        index = i;\r\n      }\r\n    }\r\n    var features = data.layers[index].featureSet.features;\r\n    var geometryType = data.layers[index].layerDefinition.geometryType; // 'esriGeometryPoint' | 'esriGeometryMultipoint' | 'esriGeometryPolyline' | 'esriGeometryPolygon' | 'esriGeometryEnvelope'\r\n    var objectIdField = data.layers[index].layerDefinition.objectIdField;\r\n    var layerDefinition = data.layers[index].layerDefinition || null;\r\n\r\n    if (data.layers[index].layerDefinition.extent.spatialReference.wkid !== 4326) {\r\n      if (data.layers[index].layerDefinition.extent.spatialReference.wkid !== 102100) {\r\n        console.error('[L.esri.WebMap] this wkid (' + data.layers[index].layerDefinition.extent.spatialReference.wkid + ') is not supported.');\r\n      }\r\n      features = this._projTo4326(features, geometryType);\r\n    }\r\n    if (data.layers[index].popupInfo !== undefined) {\r\n      this.popupInfo = data.layers[index].popupInfo;\r\n    }\r\n    if (data.layers[index].layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n      this.labelingInfo = data.layers[index].layerDefinition.drawingInfo.labelingInfo;\r\n    }\r\n    console.log(data);\r\n\r\n    var geojson = this._featureCollectionToGeoJSON(features, objectIdField);\r\n\r\n    if (layerDefinition !== null) {\r\n      setRenderer(layerDefinition, this);\r\n    }\r\n    console.log(geojson);\r\n    this.addData(geojson);\r\n  },\r\n\r\n  _projTo4326: function (features, geometryType) {\r\n    console.log('_project!');\r\n    var i, len;\r\n    var projFeatures = [];\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var f = features[i];\r\n      var mercatorToLatlng;\r\n      var j, k;\r\n\r\n      if (geometryType === 'esriGeometryPoint') {\r\n        mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.x, f.geometry.y));\r\n        f.geometry.x = mercatorToLatlng.lng;\r\n        f.geometry.y = mercatorToLatlng.lat;\r\n      } else if (geometryType === 'esriGeometryMultipoint') {\r\n        var plen;\r\n\r\n        for (j = 0, plen = f.geometry.points.length; j < plen; j++) {\r\n          mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.points[j][0], f.geometry.points[j][1]));\r\n          f.geometry.points[j][0] = mercatorToLatlng.lng;\r\n          f.geometry.points[j][1] = mercatorToLatlng.lat;\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolyline') {\r\n        var pathlen, pathslen;\r\n\r\n        for (j = 0, pathslen = f.geometry.paths.length; j < pathslen; j++) {\r\n          for (k = 0, pathlen = f.geometry.paths[j].length; k < pathlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.paths[j][k][0], f.geometry.paths[j][k][1]));\r\n            f.geometry.paths[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.paths[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolygon') {\r\n        var ringlen, ringslen;\r\n\r\n        for (j = 0, ringslen = f.geometry.rings.length; j < ringslen; j++) {\r\n          for (k = 0, ringlen = f.geometry.rings[j].length; k < ringlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.rings[j][k][0], f.geometry.rings[j][k][1]));\r\n            f.geometry.rings[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.rings[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      }\r\n      projFeatures.push(f);\r\n    }\r\n\r\n    return projFeatures;\r\n  },\r\n\r\n  _featureCollectionToGeoJSON: function (features, objectIdField) {\r\n    var geojsonFeatureCollection = {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n    var featuresArray = [];\r\n    var i, len;\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var geojson = arcgisToGeoJSON(features[i], objectIdField);\r\n      featuresArray.push(geojson);\r\n    }\r\n\r\n    geojsonFeatureCollection.features = featuresArray;\r\n\r\n    return geojsonFeatureCollection;\r\n  }\r\n});\r\n\r\nexport function featureCollection (geojson, options) {\r\n  return new FeatureCollection(geojson, options);\r\n}\r\n\r\nexport default featureCollection;\r\n","import L from 'leaflet';\r\n\r\nimport omnivore from 'leaflet-omnivore';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var CSVLayer = L.GeoJSON.extend({\r\n  options: {\r\n    url: '',\r\n    data: {}, // Esri Feature Collection JSON or Item ID\r\n    opacity: 1\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.url = this.options.url;\r\n    this.layerDefinition = this.options.layerDefinition;\r\n    this.locationInfo = this.options.locationInfo;\r\n    this.opacity = this.options.opacity;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    this._parseCSV(this.url, this.layerDefinition, this.locationInfo);\r\n  },\r\n\r\n  _parseCSV: function (url, layerDefinition, locationInfo) {\r\n    omnivore.csv(url, {\r\n      latfield: locationInfo.latitudeFieldName,\r\n      lonfield: locationInfo.longitudeFieldName\r\n    }, this);\r\n\r\n    setRenderer(layerDefinition, this);\r\n  }\r\n});\r\n\r\nexport function csvLayer (geojson, options) {\r\n  return new CSVLayer(geojson, options);\r\n}\r\n\r\nexport default CSVLayer;\r\n","import L from 'leaflet';\r\n\r\nimport { arcgisToGeoJSON } from 'arcgis-to-geojson-utils';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var KMLLayer = L.GeoJSON.extend({\r\n  options: {\r\n    opacity: 1,\r\n    url: ''\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.url = this.options.url;\r\n    this.opacity = this.options.opacity;\r\n    this.popupInfo = null;\r\n    this.labelingInfo = null;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    this._getKML(this.url);\r\n  },\r\n\r\n  _getKML: function (url) {\r\n    var requestUrl = 'http://utility.arcgis.com/sharing/kml?url=' + url + '&model=simple&folders=&outSR=%7B\"wkid\"%3A4326%7D';\r\n    L.esri.request(requestUrl, {}, function (err, res) {\r\n      if (err) {\r\n        console.log(err);\r\n      } else {\r\n        console.log(res);\r\n        this._parseFeatureCollection(res.featureCollection);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  _parseFeatureCollection: function (featureCollection) {\r\n    console.log('_parseFeatureCollection');\r\n    var i;\r\n    for (i = 0; i < 3; i++) {\r\n      if (featureCollection.layers[i].featureSet.features.length > 0) {\r\n        console.log(i);\r\n        var features = featureCollection.layers[i].featureSet.features;\r\n        var objectIdField = featureCollection.layers[i].layerDefinition.objectIdField;\r\n\r\n        var geojson = this._featureCollectionToGeoJSON(features, objectIdField);\r\n\r\n        if (featureCollection.layers[i].popupInfo !== undefined) {\r\n          this.popupInfo = featureCollection.layers[i].popupInfo;\r\n        }\r\n        if (featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n          this.labelingInfo = featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo;\r\n        }\r\n\r\n        setRenderer(featureCollection.layers[i].layerDefinition, this);\r\n        console.log(geojson);\r\n        this.addData(geojson);\r\n      }\r\n    }\r\n  },\r\n\r\n  _featureCollectionToGeoJSON: function (features, objectIdField) {\r\n    var geojsonFeatureCollection = {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n    var featuresArray = [];\r\n    var i, len;\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var geojson = arcgisToGeoJSON(features[i], objectIdField);\r\n      featuresArray.push(geojson);\r\n    }\r\n\r\n    geojsonFeatureCollection.features = featuresArray;\r\n\r\n    return geojsonFeatureCollection;\r\n  }\r\n});\r\n\r\nexport function kmlLayer (geojson, options) {\r\n  return new KMLLayer(geojson, options);\r\n}\r\n\r\nexport default KMLLayer;\r\n","import L from 'leaflet';\r\n\r\nexport var LabelIcon = L.DivIcon.extend({\r\n  options: {\r\n    iconSize: null,\r\n    className: 'esri-leaflet-webmap-labels',\r\n    text: ''\r\n  },\r\n\r\n  createIcon: function (oldIcon) {\r\n    var div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div');\r\n    var options = this.options;\r\n\r\n    div.innerHTML = '<div style=\"position: relative; left: -50%; text-shadow: 1px 1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff, -1px -1px 0px #fff;\">' + options.text + '</div>';\r\n\r\n    // label.css\r\n    div.style.fontSize = '1em';\r\n    div.style.fontWeight = 'bold';\r\n    div.style.textTransform = 'uppercase';\r\n    div.style.textAlign = 'center';\r\n    div.style.whiteSpace = 'nowrap';\r\n\r\n    if (options.bgPos) {\r\n      var bgPos = L.point(options.bgPos);\r\n      div.style.backgroundPosition = (-bgPos.x) + 'px ' + (-bgPos.y) + 'px';\r\n    }\r\n    this._setIconStyles(div, 'icon');\r\n\r\n    return div;\r\n  }\r\n});\r\n\r\nexport function labelIcon (options) {\r\n  return new LabelIcon(options);\r\n}\r\n\r\nexport default labelIcon;\r\n","import L from 'leaflet';\r\nimport { labelIcon } from './LabelIcon';\r\n\r\nexport var LabelMarker = L.Marker.extend({\r\n  options: {\r\n    properties: {},\r\n    labelingInfo: {},\r\n    offset: [0, 0]\r\n  },\r\n\r\n  initialize: function (latlng, options) {\r\n    L.setOptions(this, options);\r\n    this._latlng = L.latLng(latlng);\r\n\r\n    var labelText = this._createLabelText(this.options.properties, this.options.labelingInfo);\r\n    this._setLabelIcon(labelText, this.options.offset);\r\n  },\r\n\r\n  _createLabelText: function (properties, labelingInfo) {\r\n    var r = /\\[([^\\]]*)\\]/g;\r\n    var labelText = labelingInfo[0].labelExpression;\r\n\r\n    labelText = labelText.replace(r, function (s) {\r\n      var m = r.exec(s);\r\n      return properties[m[1]];\r\n    });\r\n\r\n    return labelText;\r\n  },\r\n\r\n  _setLabelIcon: function (text, offset) {\r\n    var icon = labelIcon({\r\n      text: text,\r\n      iconAnchor: offset\r\n    });\r\n\r\n    this.setIcon(icon);\r\n  }\r\n});\r\n\r\nexport function labelMarker (latlng, options) {\r\n  return new LabelMarker(latlng, options);\r\n}\r\n\r\nexport default labelMarker;\r\n","export function pointLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = coordinates.reverse();\r\n  labelPos.offset = [20, 20];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PointLabel = {\r\n  pointLabelPos: pointLabelPos\r\n};\r\n\r\nexport default PointLabel;\r\n","export function polylineLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n  var centralKey;\r\n\r\n  centralKey = Math.round(coordinates.length / 2);\r\n  labelPos.position = coordinates[centralKey].reverse();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolylineLabel = {\r\n  polylineLabelPos: polylineLabelPos\r\n};\r\n\r\nexport default PolylineLabel;\r\n","export function polygonLabelPos (layer, coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = layer.getBounds().getCenter();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolygonLabel = {\r\n  polygonLabelPos: polygonLabelPos\r\n};\r\n\r\nexport default PolygonLabel;\r\n","var getDayOfYear = require('../get_day_of_year/index.js')\nvar getISOWeek = require('../get_iso_week/index.js')\nvar getISOYear = require('../get_iso_year/index.js')\nvar parse = require('../parse/index.js')\nvar isValid = require('../is_valid/index.js')\nvar enLocale = require('../locale/en/index.js')\n\n/**\n * @category Common Helpers\n * @summary Format the date.\n *\n * @description\n * Return the formatted date string in the given format.\n *\n * Accepted tokens:\n * | Unit                    | Token | Result examples                  |\n * |-------------------------|-------|----------------------------------|\n * | Month                   | M     | 1, 2, ..., 12                    |\n * |                         | Mo    | 1st, 2nd, ..., 12th              |\n * |                         | MM    | 01, 02, ..., 12                  |\n * |                         | MMM   | Jan, Feb, ..., Dec               |\n * |                         | MMMM  | January, February, ..., December |\n * | Quarter                 | Q     | 1, 2, 3, 4                       |\n * |                         | Qo    | 1st, 2nd, 3rd, 4th               |\n * | Day of month            | D     | 1, 2, ..., 31                    |\n * |                         | Do    | 1st, 2nd, ..., 31st              |\n * |                         | DD    | 01, 02, ..., 31                  |\n * | Day of year             | DDD   | 1, 2, ..., 366                   |\n * |                         | DDDo  | 1st, 2nd, ..., 366th             |\n * |                         | DDDD  | 001, 002, ..., 366               |\n * | Day of week             | d     | 0, 1, ..., 6                     |\n * |                         | do    | 0th, 1st, ..., 6th               |\n * |                         | dd    | Su, Mo, ..., Sa                  |\n * |                         | ddd   | Sun, Mon, ..., Sat               |\n * |                         | dddd  | Sunday, Monday, ..., Saturday    |\n * | Day of ISO week         | E     | 1, 2, ..., 7                     |\n * | ISO week                | W     | 1, 2, ..., 53                    |\n * |                         | Wo    | 1st, 2nd, ..., 53rd              |\n * |                         | WW    | 01, 02, ..., 53                  |\n * | Year                    | YY    | 00, 01, ..., 99                  |\n * |                         | YYYY  | 1900, 1901, ..., 2099            |\n * | ISO week-numbering year | GG    | 00, 01, ..., 99                  |\n * |                         | GGGG  | 1900, 1901, ..., 2099            |\n * | AM/PM                   | A     | AM, PM                           |\n * |                         | a     | am, pm                           |\n * |                         | aa    | a.m., p.m.                       |\n * | Hour                    | H     | 0, 1, ... 23                     |\n * |                         | HH    | 00, 01, ... 23                   |\n * |                         | h     | 1, 2, ..., 12                    |\n * |                         | hh    | 01, 02, ..., 12                  |\n * | Minute                  | m     | 0, 1, ..., 59                    |\n * |                         | mm    | 00, 01, ..., 59                  |\n * | Second                  | s     | 0, 1, ..., 59                    |\n * |                         | ss    | 00, 01, ..., 59                  |\n * | 1/10 of second          | S     | 0, 1, ..., 9                     |\n * | 1/100 of second         | SS    | 00, 01, ..., 99                  |\n * | Millisecond             | SSS   | 000, 001, ..., 999               |\n * | Timezone                | Z     | -01:00, +00:00, ... +12:00       |\n * |                         | ZZ    | -0100, +0000, ..., +1200         |\n * | Seconds timestamp       | X     | 512969520                        |\n * | Milliseconds timestamp  | x     | 512969520900                     |\n *\n * The characters wrapped in square brackets are escaped.\n *\n * The result may vary by locale.\n *\n * @param {Date|String|Number} date - the original date\n * @param {String} [format='YYYY-MM-DDTHH:mm:ss.SSSZ'] - the string of tokens\n * @param {Object} [options] - the object with options\n * @param {Object} [options.locale=enLocale] - the locale object\n * @returns {String} the formatted date string\n *\n * @example\n * // Represent 11 February 2014 in middle-endian format:\n * var result = format(\n *   new Date(2014, 1, 11),\n *   'MM/DD/YYYY'\n * )\n * //=> '02/11/2014'\n *\n * @example\n * // Represent 2 July 2014 in Esperanto:\n * var eoLocale = require('date-fns/locale/eo')\n * var result = format(\n *   new Date(2014, 6, 2),\n *   'Do [de] MMMM YYYY',\n *   {locale: eoLocale}\n * )\n * //=> '2-a de julio 2014'\n */\nfunction format (dirtyDate, dirtyFormatStr, dirtyOptions) {\n  var formatStr = dirtyFormatStr ? String(dirtyFormatStr) : 'YYYY-MM-DDTHH:mm:ss.SSSZ'\n  var options = dirtyOptions || {}\n\n  var locale = options.locale\n  var localeFormatters = enLocale.format.formatters\n  var formattingTokensRegExp = enLocale.format.formattingTokensRegExp\n  if (locale && locale.format && locale.format.formatters) {\n    localeFormatters = locale.format.formatters\n\n    if (locale.format.formattingTokensRegExp) {\n      formattingTokensRegExp = locale.format.formattingTokensRegExp\n    }\n  }\n\n  var date = parse(dirtyDate)\n\n  if (!isValid(date)) {\n    return 'Invalid Date'\n  }\n\n  var formatFn = buildFormatFn(formatStr, localeFormatters, formattingTokensRegExp)\n\n  return formatFn(date)\n}\n\nvar formatters = {\n  // Month: 1, 2, ..., 12\n  'M': function (date) {\n    return date.getMonth() + 1\n  },\n\n  // Month: 01, 02, ..., 12\n  'MM': function (date) {\n    return addLeadingZeros(date.getMonth() + 1, 2)\n  },\n\n  // Quarter: 1, 2, 3, 4\n  'Q': function (date) {\n    return Math.ceil((date.getMonth() + 1) / 3)\n  },\n\n  // Day of month: 1, 2, ..., 31\n  'D': function (date) {\n    return date.getDate()\n  },\n\n  // Day of month: 01, 02, ..., 31\n  'DD': function (date) {\n    return addLeadingZeros(date.getDate(), 2)\n  },\n\n  // Day of year: 1, 2, ..., 366\n  'DDD': function (date) {\n    return getDayOfYear(date)\n  },\n\n  // Day of year: 001, 002, ..., 366\n  'DDDD': function (date) {\n    return addLeadingZeros(getDayOfYear(date), 3)\n  },\n\n  // Day of week: 0, 1, ..., 6\n  'd': function (date) {\n    return date.getDay()\n  },\n\n  // Day of ISO week: 1, 2, ..., 7\n  'E': function (date) {\n    return date.getDay() || 7\n  },\n\n  // ISO week: 1, 2, ..., 53\n  'W': function (date) {\n    return getISOWeek(date)\n  },\n\n  // ISO week: 01, 02, ..., 53\n  'WW': function (date) {\n    return addLeadingZeros(getISOWeek(date), 2)\n  },\n\n  // Year: 00, 01, ..., 99\n  'YY': function (date) {\n    return addLeadingZeros(date.getFullYear(), 4).substr(2)\n  },\n\n  // Year: 1900, 1901, ..., 2099\n  'YYYY': function (date) {\n    return addLeadingZeros(date.getFullYear(), 4)\n  },\n\n  // ISO week-numbering year: 00, 01, ..., 99\n  'GG': function (date) {\n    return String(getISOYear(date)).substr(2)\n  },\n\n  // ISO week-numbering year: 1900, 1901, ..., 2099\n  'GGGG': function (date) {\n    return getISOYear(date)\n  },\n\n  // Hour: 0, 1, ... 23\n  'H': function (date) {\n    return date.getHours()\n  },\n\n  // Hour: 00, 01, ..., 23\n  'HH': function (date) {\n    return addLeadingZeros(date.getHours(), 2)\n  },\n\n  // Hour: 1, 2, ..., 12\n  'h': function (date) {\n    var hours = date.getHours()\n    if (hours === 0) {\n      return 12\n    } else if (hours > 12) {\n      return hours % 12\n    } else {\n      return hours\n    }\n  },\n\n  // Hour: 01, 02, ..., 12\n  'hh': function (date) {\n    return addLeadingZeros(formatters['h'](date), 2)\n  },\n\n  // Minute: 0, 1, ..., 59\n  'm': function (date) {\n    return date.getMinutes()\n  },\n\n  // Minute: 00, 01, ..., 59\n  'mm': function (date) {\n    return addLeadingZeros(date.getMinutes(), 2)\n  },\n\n  // Second: 0, 1, ..., 59\n  's': function (date) {\n    return date.getSeconds()\n  },\n\n  // Second: 00, 01, ..., 59\n  'ss': function (date) {\n    return addLeadingZeros(date.getSeconds(), 2)\n  },\n\n  // 1/10 of second: 0, 1, ..., 9\n  'S': function (date) {\n    return Math.floor(date.getMilliseconds() / 100)\n  },\n\n  // 1/100 of second: 00, 01, ..., 99\n  'SS': function (date) {\n    return addLeadingZeros(Math.floor(date.getMilliseconds() / 10), 2)\n  },\n\n  // Millisecond: 000, 001, ..., 999\n  'SSS': function (date) {\n    return addLeadingZeros(date.getMilliseconds(), 3)\n  },\n\n  // Timezone: -01:00, +00:00, ... +12:00\n  'Z': function (date) {\n    return formatTimezone(date.getTimezoneOffset(), ':')\n  },\n\n  // Timezone: -0100, +0000, ... +1200\n  'ZZ': function (date) {\n    return formatTimezone(date.getTimezoneOffset())\n  },\n\n  // Seconds timestamp: 512969520\n  'X': function (date) {\n    return Math.floor(date.getTime() / 1000)\n  },\n\n  // Milliseconds timestamp: 512969520900\n  'x': function (date) {\n    return date.getTime()\n  }\n}\n\nfunction buildFormatFn (formatStr, localeFormatters, formattingTokensRegExp) {\n  var array = formatStr.match(formattingTokensRegExp)\n  var length = array.length\n\n  var i\n  var formatter\n  for (i = 0; i < length; i++) {\n    formatter = localeFormatters[array[i]] || formatters[array[i]]\n    if (formatter) {\n      array[i] = formatter\n    } else {\n      array[i] = removeFormattingTokens(array[i])\n    }\n  }\n\n  return function (date) {\n    var output = ''\n    for (var i = 0; i < length; i++) {\n      if (array[i] instanceof Function) {\n        output += array[i](date, formatters)\n      } else {\n        output += array[i]\n      }\n    }\n    return output\n  }\n}\n\nfunction removeFormattingTokens (input) {\n  if (input.match(/\\[[\\s\\S]/)) {\n    return input.replace(/^\\[|]$/g, '')\n  }\n  return input.replace(/\\\\/g, '')\n}\n\nfunction formatTimezone (offset, delimeter) {\n  delimeter = delimeter || ''\n  var sign = offset > 0 ? '-' : '+'\n  var absOffset = Math.abs(offset)\n  var hours = Math.floor(absOffset / 60)\n  var minutes = absOffset % 60\n  return sign + addLeadingZeros(hours, 2) + delimeter + addLeadingZeros(minutes, 2)\n}\n\nfunction addLeadingZeros (number, targetLength) {\n  var output = Math.abs(number).toString()\n  while (output.length < targetLength) {\n    output = '0' + output\n  }\n  return output\n}\n\nmodule.exports = format\n","import * as format from 'date-fns/format';\r\nconsole.log('format:', format);\r\n\r\nfunction transformPhoneNumber(value) {\r\n  var s2 = (\"\"+value).replace(/\\D/g, '');\r\n  var m = s2.match(/^(\\d{3})(\\d{3})(\\d{4})$/);\r\n  return (!m) ? null : \"(\" + m[1] + \") \" + m[2] + \"-\" + m[3];\r\n}\r\n\r\nfunction transformDate(value) {\r\n  // var moment = globals.moment;\r\n  // return moment(value).format('MM/DD/YYYY');\r\n  return format(value, 'MM/DD/YYYY');\r\n  // return value;\r\n}\r\n\r\nfunction transformDecimalPlace(value) {\r\n  var number = String(value).match(/\\d+/)[0].replace(/(.)(?=(\\d{3})+$)/g,'$1,');\r\n  var label = String(value).replace(/[0-9]/g, '') || '';\r\n  return number + ' ' + label;\r\n}\r\n\r\n\r\nexport function createPopupContent (popupInfo, properties) {\r\n  // console.log('popupInfo:', popupInfo);\r\n  // console.log('popup properties:', properties);\r\n  var r = /\\{([^\\]]*)\\}/g;\r\n  var titleText = '';\r\n  var content = '';\r\n\r\n  if (popupInfo.title !== undefined) {\r\n    titleText = popupInfo.title;\r\n  }\r\n\r\n  titleText = titleText.replace(r, function (s) {\r\n    var m = r.exec(s);\r\n    return properties[m[1]];\r\n  });\r\n\r\n  content = '<div class=\"leaflet-popup-content-title text-center\"><h4>' + titleText + '</h4></div><div class=\"leaflet-popup-content-description\" style=\"max-height:200px;overflow:auto;\">';\r\n\r\n  var contentStart = '<div style=\"font-weight:bold;color:#999;margin-top:5px;word-break:break-all;\">'\r\n  var contentMiddle = '</div><p style=\"margin-top:0;margin-bottom:5px;word-break:break-all;\">'\r\n  var aTagStart = '<a target=\"_blank\" href=\"'\r\n  var emailTagStart = '<a href=\"mailto:'\r\n\r\n  if (popupInfo.fieldInfos !== undefined) {\r\n    for (var i = 0; i < popupInfo.fieldInfos.length; i++) {\r\n      if (popupInfo.fieldInfos[i].visible === true) {\r\n        if (properties[popupInfo.fieldInfos[i].fieldName] === null) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  // + aTagStart\r\n                  // + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + 'none'\r\n                  // + '\">'\r\n                  // + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</p>';\r\n        // if the info is a URL\r\n        } else if (popupInfo.fieldInfos[i].fieldName === 'URL' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'CODE_SEC_1' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'WEBSITE' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'FINAL_LINK_COPY' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'LINK' ||\r\n            // zoning overlays:\r\n            popupInfo.fieldInfos[i].fieldName === 'CODE_SECTION_LINK'\r\n        ) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + aTagStart\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '\">'\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</a></p>';\r\n        // if the info is an email address\r\n        } else if (popupInfo.fieldInfos[i].fieldName.includes('EMAIL')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + emailTagStart\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '\">'\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</a></p>';\r\n        // if the info is a phone number\r\n        } else if (popupInfo.fieldInfos[i].fieldName.includes('PHONE')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + transformPhoneNumber(properties[popupInfo.fieldInfos[i].fieldName])\r\n                  + '</p>';\r\n        // if the info is a date\r\n      } else if (popupInfo.fieldInfos[i].fieldName.includes('DATE')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + transformDate(properties[popupInfo.fieldInfos[i].fieldName])\r\n                  + '</p>';\r\n        } else {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</p>';\r\n        }\r\n      }\r\n    }\r\n    content += '</div>';\r\n\r\n  } else if (popupInfo.description !== undefined) {\r\n    // KMLLayer popup\r\n    var descriptionText = popupInfo.description.replace(r, function (s) {\r\n      var m = r.exec(s);\r\n      return properties[m[1]];\r\n    });\r\n    content += descriptionText + '</div>';\r\n  }\r\n\r\n  // if (popupInfo.mediaInfos.length > 0) {\r\n    // It does not support mediaInfos for popup contents.\r\n  // }\r\n\r\n  return content;\r\n}\r\n\r\nexport var Popup = {\r\n  createPopupContent: createPopupContent\r\n};\r\n\r\nexport default Popup;\r\n","import L from 'leaflet';\r\nimport { featureCollection } from './FeatureCollection/FeatureCollection';\r\nimport { csvLayer } from './FeatureCollection/CSVLayer';\r\nimport { kmlLayer } from './FeatureCollection/KMLLayer';\r\nimport { labelMarker } from './Label/LabelMarker';\r\nimport { pointLabelPos } from './Label/PointLabel';\r\nimport { polylineLabelPos } from './Label/PolylineLabel';\r\nimport { polygonLabelPos } from './Label/PolygonLabel';\r\nimport { createPopupContent } from './Popup/Popup';\r\n\r\nexport function operationalLayer (layer, layers, map, params, paneName) {\r\n  // console.log('operationalLayer, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n  return _generateEsriLayer(layer, layers, map, params, paneName);\r\n}\r\n\r\nexport function _generateEsriLayer (layer, layers, map, params, paneName) {\r\n  // console.log('generateEsriLayer: ', layer.title, 'paneName:', paneName, 'layer:', layer);\r\n  var lyr;\r\n  var labels = [];\r\n  var labelsLayer;\r\n  var labelPaneName = paneName + '-label';\r\n  var i, len;\r\n\r\n  if (layer.type === 'Feature Collection' || layer.featureCollection !== undefined) {\r\n    // console.log('create FeatureCollection');\r\n\r\n    map.createPane(labelPaneName);\r\n\r\n    var popupInfo, labelingInfo;\r\n    if (layer.itemId === undefined) {\r\n      for (i = 0, len = layer.featureCollection.layers.length; i < len; i++) {\r\n        if (layer.featureCollection.layers[i].featureSet.features.length > 0) {\r\n          if (layer.featureCollection.layers[i].popupInfo !== undefined && layer.featureCollection.layers[i].popupInfo !== null) {\r\n            popupInfo = layer.featureCollection.layers[i].popupInfo;\r\n          }\r\n          if (layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== undefined && layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== null) {\r\n            labelingInfo = layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    labelsLayer = L.featureGroup(labels);\r\n    var fc = featureCollection(null, {\r\n      data: layer.itemId || layer.featureCollection,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (fc !== undefined) {\r\n          popupInfo = fc.popupInfo;\r\n          labelingInfo = fc.labelingInfo;\r\n        }\r\n        if (popupInfo !== undefined && popupInfo !== null) {\r\n          var popupContent = createPopupContent(popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (labelingInfo !== undefined && labelingInfo !== null) {\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([fc, labelsLayer]);\r\n\r\n    layers.push({ type: 'FC', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer' && layer.layerDefinition !== undefined) {\r\n    var where = '1=1';\r\n    if (layer.layerDefinition.drawingInfo !== undefined) {\r\n      if (layer.layerDefinition.drawingInfo.renderer.type === 'heatmap') {\r\n        // console.log('create HeatmapLayer');\r\n        var gradient = {};\r\n\r\n        layer.layerDefinition.drawingInfo.renderer.colorStops.map(function (stop) {\r\n          // gradient[stop.ratio] = 'rgba(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ',' + (stop.color[3]/255) + ')';\r\n          // gradient[Math.round(stop.ratio*100)/100] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n          gradient[(Math.round(stop.ratio * 100) / 100 + 6) / 7] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n        });\r\n\r\n        lyr = L.esri.Heat.heatmapFeatureLayer({ // Esri Leaflet 2.0\r\n        // lyr = L.esri.heatmapFeatureLayer({ // Esri Leaflet 1.0\r\n          url: layer.url,\r\n          token: params.token || null,\r\n          minOpacity: 0.5,\r\n          max: layer.layerDefinition.drawingInfo.renderer.maxPixelIntensity,\r\n          blur: layer.layerDefinition.drawingInfo.renderer.blurRadius,\r\n          radius: layer.layerDefinition.drawingInfo.renderer.blurRadius * 1.3,\r\n          gradient: gradient,\r\n          pane: paneName\r\n        });\r\n\r\n        layers.push({ type: 'HL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      } else {\r\n        // console.log('create ArcGISFeatureLayer (with layerDefinition.drawingInfo)');\r\n        var drawingInfo = layer.layerDefinition.drawingInfo;\r\n        drawingInfo.transparency = 100 - (layer.opacity * 100);\r\n        // console.log(drawingInfo.transparency);\r\n\r\n        if (layer.layerDefinition.definitionExpression !== undefined) {\r\n          where = layer.layerDefinition.definitionExpression;\r\n        }\r\n\r\n        map.createPane(labelPaneName);\r\n\r\n        labelsLayer = L.featureGroup(labels);\r\n\r\n        lyr = L.esri.featureLayer({\r\n          url: layer.url,\r\n          where: where,\r\n          token: params.token || null,\r\n          drawingInfo: drawingInfo,\r\n          pane: paneName,\r\n          onEachFeature: function (geojson, l) {\r\n            l.feature.layerName = layer.title.split('_')[1];\r\n            if (layer.popupInfo !== undefined) {\r\n              var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n              // l.bindPopup(popupContent);\r\n              l.feature.popupHtml = popupContent\r\n            }\r\n            if (layer.layerDefinition.drawingInfo.labelingInfo !== undefined && layer.layerDefinition.drawingInfo.labelingInfo !== null) {\r\n              var labelingInfo = layer.layerDefinition.drawingInfo.labelingInfo;\r\n              var coordinates = l.feature.geometry.coordinates;\r\n              var labelPos;\r\n\r\n              if (l.feature.geometry.type === 'Point') {\r\n                labelPos = pointLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'LineString') {\r\n                labelPos = polylineLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'MultiLineString') {\r\n                labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n              } else {\r\n                labelPos = polygonLabelPos(l);\r\n              }\r\n\r\n              var label = labelMarker(labelPos.position, {\r\n                zIndexOffset: 1,\r\n                properties: geojson.properties,\r\n                labelingInfo: labelingInfo,\r\n                offset: labelPos.offset,\r\n                pane: labelPaneName\r\n              });\r\n\r\n              labelsLayer.addLayer(label);\r\n            }\r\n          }\r\n        });\r\n\r\n        lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n        layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      }\r\n    } else {\r\n      // console.log('create ArcGISFeatureLayer (without layerDefinition.drawingInfo)');\r\n\r\n      if (layer.layerDefinition.definitionExpression !== undefined) {\r\n        where = layer.layerDefinition.definitionExpression;\r\n      }\r\n\r\n      lyr = L.esri.featureLayer({\r\n        url: layer.url,\r\n        token: params.token || null,\r\n        where: where,\r\n        pane: paneName,\r\n        onEachFeature: function (geojson, l) {\r\n          l.feature.layerName = layer.title.split('_')[1];\r\n          if (layer.popupInfo !== undefined) {\r\n            var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n            // l.bindPopup(popupContent);\r\n            l.feature.popupHtml = popupContent\r\n          }\r\n        }\r\n      });\r\n\r\n      layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n      return lyr;\r\n    }\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer') {\r\n    // console.log('create ArcGISFeatureLayer');\r\n    lyr = L.esri.featureLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (layer.popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n      }\r\n    });\r\n\r\n    layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'CSV') {\r\n    labelsLayer = L.featureGroup(labels);\r\n    lyr = csvLayer(null, {\r\n      url: layer.url,\r\n      layerDefinition: layer.layerDefinition,\r\n      locationInfo: layer.locationInfo,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (layer.popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (layer.layerDefinition.drawingInfo.labelingInfo !== undefined && layer.layerDefinition.drawingInfo.labelingInfo !== null) {\r\n          var labelingInfo = layer.layerDefinition.drawingInfo.labelingInfo;\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n    layers.push({ type: 'CSV', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'KML') {\r\n    labelsLayer = L.featureGroup(labels);\r\n    var kml = kmlLayer(null, {\r\n      url: layer.url,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (kml.popupInfo !== undefined && kml.popupInfo !== null) {\r\n          // console.log(kml.popupInfo);\r\n          var popupContent = createPopupContent(kml.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (kml.labelingInfo !== undefined && kml.labelingInfo !== null) {\r\n          var labelingInfo = kml.labelingInfo;\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([kml, labelsLayer]);\r\n\r\n    layers.push({ type: 'KML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISImageServiceLayer') {\r\n    // console.log('create ArcGISImageServiceLayer');\r\n    lyr = L.esri.imageMapLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'IML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISMapServiceLayer') {\r\n    lyr = L.esri.dynamicMapLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'DML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISTiledMapServiceLayer') {\r\n    try {\r\n      lyr = L.esri.basemapLayer(layer.title);\r\n    } catch (e) {\r\n      lyr = L.esri.tiledMapLayer({\r\n        url: layer.url,\r\n        token: params.token || null\r\n      });\r\n\r\n      L.esri.request(layer.url, {}, function (err, res) {\r\n        if (err) {\r\n          console.log(err);\r\n        } else {\r\n          var maxWidth = (map.getSize().x - 55);\r\n          var tiledAttribution = '<span class=\"esri-attributions\" style=\"line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block; max-width:' + maxWidth + 'px;\">' + res.copyrightText + '</span>';\r\n          map.attributionControl.addAttribution(tiledAttribution);\r\n        }\r\n      });\r\n    }\r\n\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'VectorTileLayer') {\r\n    var keys = {\r\n      'World Street Map (with Relief)': 'StreetsRelief',\r\n      'World Street Map (with Relief) (Mature Support)': 'StreetsRelief',\r\n      'Hybrid Reference Layer': 'Hybrid',\r\n      'Hybrid Reference Layer (Mature Support)': 'Hybrid',\r\n      'World Street Map': 'Streets',\r\n      'World Street Map (Mature Support)': 'Streets',\r\n      'World Street Map (Night)': 'StreetsNight',\r\n      'World Street Map (Night) (Mature Support)': 'StreetsNight',\r\n      'Dark Gray Canvas': 'DarkGray',\r\n      'Dark Gray Canvas (Mature Support)': 'DarkGray',\r\n      'World Topographic Map': 'Topographic',\r\n      'World Topographic Map (Mature Support)': 'Topographic',\r\n      'World Navigation Map': 'Navigation',\r\n      'World Navigation Map (Mature Support)': 'Navigation',\r\n      'Light Gray Canvas': 'Gray',\r\n      'Light Gray Canvas (Mature Support)': 'Gray'\r\n      //'Terrain with Labels': '',\r\n      //'World Terrain with Labels': '',\r\n      //'Light Gray Canvas Reference': '',\r\n      //'Dark Gray Canvas Reference': '',\r\n      //'Dark Gray Canvas Base': '',\r\n      //'Light Gray Canvas Base': ''\r\n    };\r\n\r\n    if (keys[layer.title]) {\r\n      lyr = L.esri.Vector.basemap(keys[layer.title]);\r\n    } else {\r\n      console.error('Unsupported Vector Tile Layer: ', layer);\r\n      lyr = L.featureGroup([]);\r\n    }\r\n\r\n    layers.push({ type: 'VTL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'OpenStreetMap') {\r\n    lyr = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n    });\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'WebTiledLayer') {\r\n    var lyrUrl = _esriWTLUrlTemplateToLeaflet(layer.templateUrl);\r\n    lyr = L.tileLayer(lyrUrl, {\r\n      attribution: layer.copyright\r\n    });\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'WMS') {\r\n    var layerNames = '';\r\n    for (i = 0, len = layer.visibleLayers.length; i < len; i++) {\r\n      layerNames += layer.visibleLayers[i];\r\n      if (i < len - 1) {\r\n        layerNames += ',';\r\n      }\r\n    }\r\n\r\n    lyr = L.tileLayer.wms(layer.url, {\r\n      layers: String(layerNames),\r\n      format: 'image/png',\r\n      transparent: true,\r\n      attribution: layer.copyright\r\n    });\r\n\r\n    layers.push({ type: 'WMS', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else {\r\n    lyr = L.featureGroup([]);\r\n    console.log('Unsupported Layer: ', layer);\r\n    return lyr;\r\n  }\r\n}\r\n\r\nexport function _esriWTLUrlTemplateToLeaflet (url) {\r\n  var newUrl = url;\r\n\r\n  newUrl = newUrl.replace(/\\{level}/g, '{z}');\r\n  newUrl = newUrl.replace(/\\{col}/g, '{x}');\r\n  newUrl = newUrl.replace(/\\{row}/g, '{y}');\r\n\r\n  return newUrl;\r\n}\r\n\r\nexport var OperationalLayer = {\r\n  operationalLayer: operationalLayer,\r\n  _generateEsriLayer: _generateEsriLayer,\r\n  _esriWTLUrlTemplateToLeaflet: _esriWTLUrlTemplateToLeaflet\r\n};\r\n\r\nexport default OperationalLayer;\r\n","/*\r\n * L.esri.WebMap\r\n * A leaflet plugin to display ArcGIS Web Map. https://github.com/ynunokawa/L.esri.WebMap\r\n * (c) 2016 Yusuke Nunokawa\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var webmap = L.webmap('22c504d229f14c789c5b49ebff38b941', { map: L.map('map') });\r\n * ```\r\n */\r\n\r\nimport { version } from '../package.json';\r\n\r\nimport L from 'leaflet';\r\nimport { operationalLayer } from './OperationalLayer';\r\n\r\nexport var WebMap = L.Evented.extend({\r\n  options: {\r\n    // L.Map\r\n    map: {},\r\n    // access token for secure contents on ArcGIS Online\r\n    token: null,\r\n    // server domain name (default= 'www.arcgis.com')\r\n    server: 'www.arcgis.com'\r\n  },\r\n\r\n  initialize: function (webmapId, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this._map = this.options.map;\r\n    this._token = this.options.token;\r\n    this._server = this.options.server;\r\n    this._webmapId = webmapId;\r\n    this._loaded = false;\r\n    this._metadataLoaded = false;\r\n    this._loadedLayersNum = 0;\r\n    this._layersNum = 0;\r\n\r\n    this.layers = []; // Check the layer types here -> https://github.com/ynunokawa/L.esri.WebMap/wiki/Layer-types\r\n    this.title = ''; // Web Map Title\r\n    this.bookmarks = []; // Web Map Bookmarks -> [{ name: 'Bookmark name', bounds: <L.latLngBounds> }]\r\n    this.portalItem = {}; // Web Map Metadata\r\n\r\n    this.VERSION = version;\r\n\r\n    this._loadWebMapMetaData(webmapId);\r\n    this._loadWebMap(webmapId);\r\n  },\r\n\r\n  _checkLoaded: function () {\r\n    this._loadedLayersNum++;\r\n    if (this._loadedLayersNum === this._layersNum) {\r\n      this._loaded = true;\r\n      this.fire('load');\r\n    }\r\n  },\r\n\r\n  _operationalLayer: function (layer, layers, map, params, paneName) {\r\n    var lyr = operationalLayer(layer, layers, map, params, paneName);\r\n    if (lyr !== undefined && layer.visibility === true) {\r\n      lyr.addTo(map);\r\n    }\r\n  },\r\n\r\n  _loadWebMapMetaData: function (id) {\r\n    // console.log('_loadWebMapMetaData is running, id:', id, 'this._server:', this._server);\r\n    var params = {};\r\n    var map = this._map;\r\n    var webmap = this;\r\n    var webmapMetaDataRequestUrl = 'https://' + this._server + '/sharing/rest/content/items/' + id;\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapMetaDataRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log(error);\r\n      } else {\r\n        // console.log('WebMap MetaData: ', response);\r\n        webmap.portalItem = response;\r\n        webmap.title = response.title;\r\n        webmap._metadataLoaded = true;\r\n        webmap.fire('metadataLoad');\r\n        map.fitBounds([response.extent[0].reverse(), response.extent[1].reverse()]);\r\n      }\r\n    });\r\n  },\r\n\r\n  _loadWebMap: function (id) {\r\n    var map = this._map;\r\n    var layers = this.layers;\r\n    var server = this._server;\r\n    var params = {};\r\n    var webmapRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + id + '/data';\r\n    // console.log('webmapRequestUrl:', webmapRequestUrl, 'this._token:', this._token);\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log('L.esri.request error:', error);\r\n      } else {\r\n        // console.log('WebMap: ', response);\r\n        this._layersNum = response.baseMap.baseMapLayers.length + response.operationalLayers.length;\r\n\r\n        // Add Basemap\r\n        response.baseMap.baseMapLayers.map(function (baseMapLayer) {\r\n          if (baseMapLayer.itemId !== undefined) {\r\n            var itemRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + baseMapLayer.itemId;\r\n            L.esri.request(itemRequestUrl, params, function (err, res) {\r\n              if (err) {\r\n                console.error(error);\r\n              } else {\r\n                console.log(res.access);\r\n                if (res.access !== 'public') {\r\n                  // console.log('in _loadWebMap public')\r\n                  this._operationalLayer(baseMapLayer, layers, map, params);\r\n                } else {\r\n                  // console.log('in _loadWebMap NOT public')\r\n                  this._operationalLayer(baseMapLayer, layers, map, {});\r\n                }\r\n              }\r\n              this._checkLoaded();\r\n            }, this);\r\n          } else {\r\n            this._operationalLayer(baseMapLayer, layers, map, {});\r\n            this._checkLoaded();\r\n          }\r\n        }.bind(this));\r\n\r\n        // Add Operational Layers\r\n        response.operationalLayers.map(function (layer, i) {\r\n          // console.log('response.operationalLayers, layer:', layer);\r\n          var paneName = 'esri-webmap-layer' + i;\r\n          map.createPane(paneName);\r\n          if (layer.itemId !== undefined) {\r\n            // console.log('WebMapLoader.js paneName:', paneName);\r\n            var itemRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + layer.itemId;\r\n            L.esri.request(itemRequestUrl, params, function (err, res) {\r\n              if (err) {\r\n                console.error(error);\r\n              } else {\r\n                console.log(res.access);\r\n                if (res.access !== 'public') {\r\n                  // console.log('inside public, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n                  this._operationalLayer(layer, layers, map, params, paneName);\r\n                } else {\r\n                  // console.log('NOT inside public, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n                  this._operationalLayer(layer, layers, map, {}, paneName);\r\n                }\r\n              }\r\n              this._checkLoaded();\r\n            }, this);\r\n          } else {\r\n            this._operationalLayer(layer, layers, map, {}, paneName);\r\n            this._checkLoaded();\r\n          }\r\n        }.bind(this));\r\n\r\n        // Add Bookmarks\r\n        if (response.bookmarks !== undefined && response.bookmarks.length > 0) {\r\n          response.bookmarks.map(function (bookmark) {\r\n            // Esri Extent Geometry to L.latLngBounds\r\n            var northEast = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmax, bookmark.extent.ymax));\r\n            var southWest = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmin, bookmark.extent.ymin));\r\n            var bounds = L.latLngBounds(southWest, northEast);\r\n            this.bookmarks.push({ name: bookmark.name, bounds: bounds });\r\n          }.bind(this));\r\n        }\r\n\r\n        //this._loaded = true;\r\n        //this.fire('load');\r\n      }\r\n    }.bind(this));\r\n  }\r\n});\r\n\r\nexport function webMap (webmapId, options) {\r\n  return new WebMap(webmapId, options);\r\n}\r\n\r\nexport default webMap;\r\n","import L from 'leaflet';\n\nexport var Symbol = L.Class.extend({\n  initialize: function (symbolJson, options) {\n    this._symbolJson = symbolJson;\n    this.val = null;\n    this._styles = {};\n    this._isDefault = false;\n    this._layerTransparency = 1;\n    if (options && options.layerTransparency) {\n      this._layerTransparency = 1 - (options.layerTransparency / 100.0);\n    }\n  },\n\n  // the geojson values returned are in points\n  pixelValue: function (pointValue) {\n    return pointValue * 1.333;\n  },\n\n  // color is an array [r,g,b,a]\n  colorValue: function (color) {\n    return 'rgb(' + color[0] + ',' + color[1] + ',' + color[2] + ')';\n  },\n\n  alphaValue: function (color) {\n    var alpha = color[3] / 255.0;\n    return alpha * this._layerTransparency;\n  },\n\n  getSize: function (feature, sizeInfo) {\n    var attr = feature.properties;\n    var field = sizeInfo.field;\n    var size = 0;\n    var featureValue = null;\n\n    if (field) {\n      featureValue = attr[field];\n      var minSize = sizeInfo.minSize;\n      var maxSize = sizeInfo.maxSize;\n      var minDataValue = sizeInfo.minDataValue;\n      var maxDataValue = sizeInfo.maxDataValue;\n      var featureRatio;\n      var normField = sizeInfo.normalizationField;\n      var normValue = attr ? parseFloat(attr[normField]) : undefined;\n\n      if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n        return null;\n      }\n\n      if (!isNaN(normValue)) {\n        featureValue /= normValue;\n      }\n\n      if (minSize !== null && maxSize !== null && minDataValue !== null && maxDataValue !== null) {\n        if (featureValue <= minDataValue) {\n          size = minSize;\n        } else if (featureValue >= maxDataValue) {\n          size = maxSize;\n        } else {\n          featureRatio = (featureValue - minDataValue) / (maxDataValue - minDataValue);\n          size = minSize + (featureRatio * (maxSize - minSize));\n        }\n      }\n      size = isNaN(size) ? 0 : size;\n    }\n    return size;\n  },\n\n  getColor: function (feature, colorInfo) {\n    // required information to get color\n    if (!(feature.properties && colorInfo && colorInfo.field && colorInfo.stops)) {\n      return null;\n    }\n\n    var attr = feature.properties;\n    var featureValue = attr[colorInfo.field];\n    var lowerBoundColor, upperBoundColor, lowerBound, upperBound;\n    var normField = colorInfo.normalizationField;\n    var normValue = attr ? parseFloat(attr[normField]) : undefined;\n    if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n      return null;\n    }\n\n    if (!isNaN(normValue)) {\n      featureValue /= normValue;\n    }\n\n    if (featureValue <= colorInfo.stops[0].value) {\n      return colorInfo.stops[0].color;\n    }\n    var lastStop = colorInfo.stops[colorInfo.stops.length - 1];\n    if (featureValue >= lastStop.value) {\n      return lastStop.color;\n    }\n\n    // go through the stops to find min and max\n    for (var i = 0; i < colorInfo.stops.length; i++) {\n      var stopInfo = colorInfo.stops[i];\n\n      if (stopInfo.value <= featureValue) {\n        lowerBoundColor = stopInfo.color;\n        lowerBound = stopInfo.value;\n      } else if (stopInfo.value > featureValue) {\n        upperBoundColor = stopInfo.color;\n        upperBound = stopInfo.value;\n        break;\n      }\n    }\n\n    // feature falls between two stops, interplate the colors\n    if (!isNaN(lowerBound) && !isNaN(upperBound)) {\n      var range = upperBound - lowerBound;\n      if (range > 0) {\n        // more weight the further it is from the lower bound\n        var upperBoundColorWeight = (featureValue - lowerBound) / range;\n        if (upperBoundColorWeight) {\n          // more weight the further it is from the upper bound\n          var lowerBoundColorWeight = (upperBound - featureValue) / range;\n          if (lowerBoundColorWeight) {\n            // interpolate the lower and upper bound color by applying the\n            // weights to each of the rgba colors and adding them together\n            var interpolatedColor = [];\n            for (var j = 0; j < 4; j++) {\n              interpolatedColor[j] = Math.round((lowerBoundColor[j] * lowerBoundColorWeight) + (upperBoundColor[j] * upperBoundColorWeight));\n            }\n            return interpolatedColor;\n          } else {\n            // no difference between featureValue and upperBound, 100% of upperBoundColor\n            return upperBoundColor;\n          }\n        } else {\n          // no difference between featureValue and lowerBound, 100% of lowerBoundColor\n          return lowerBoundColor;\n        }\n      }\n    }\n    // if we get to here, none of the cases apply so return null\n    return null;\n  }\n});\n\n// export function symbol (symbolJson) {\n//   return new Symbol(symbolJson);\n// }\n\nexport default Symbol;\n","import L from 'leaflet';\n\nexport var ShapeMarker = L.Path.extend({\n\n  initialize: function (latlng, size, options) {\n    L.setOptions(this, options);\n    this._size = size;\n    this._latlng = L.latLng(latlng);\n    this._svgCanvasIncludes();\n  },\n\n  toGeoJSON: function () {\n    return L.GeoJSON.getFeature(this, {\n      type: 'Point',\n      coordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\n    });\n  },\n\n  _svgCanvasIncludes: function () {\n    // implement in sub class\n  },\n\n  _project: function () {\n    this._point = this._map.latLngToLayerPoint(this._latlng);\n  },\n\n  _update: function () {\n    if (this._map) {\n      this._updatePath();\n    }\n  },\n\n  _updatePath: function () {\n    // implement in sub class\n  },\n\n  setLatLng: function (latlng) {\n    this._latlng = L.latLng(latlng);\n    this.redraw();\n    return this.fire('move', {latlng: this._latlng});\n  },\n\n  getLatLng: function () {\n    return this._latlng;\n  },\n\n  setSize: function (size) {\n    this._size = size;\n    return this.redraw();\n  },\n\n  getSize: function () {\n    return this._size;\n  }\n});\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var CrossMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateCrossMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n\n        ctx.moveTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var crossMarker = function (latlng, size, options) {\n  return new CrossMarker(latlng, size, options);\n};\n\nexport default crossMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var XMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateXMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var xMarker = function (latlng, size, options) {\n  return new XMarker(latlng, size, options);\n};\n\nexport default xMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var SquareMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateSquareMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y - offset);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var squareMarker = function (latlng, size, options) {\n  return new SquareMarker(latlng, size, options);\n};\n\nexport default squareMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var DiamondMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateDiamondMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var diamondMarker = function (latlng, size, options) {\n  return new DiamondMarker(latlng, size, options);\n};\n\nexport default diamondMarker;\n","import L from 'leaflet';\n\nimport pointSymbol from '../Symbols/PointSymbol';\nimport lineSymbol from '../Symbols/LineSymbol';\nimport polygonSymbol from '../Symbols/PolygonSymbol';\n\nexport var Renderer = L.Class.extend({\n  options: {\n    proportionalPolygon: false,\n    clickable: true\n  },\n\n  initialize: function (rendererJson, options) {\n    this._rendererJson = rendererJson;\n    this._pointSymbols = false;\n    this._symbols = [];\n    this._visualVariables = this._parseVisualVariables(rendererJson.visualVariables);\n    L.Util.setOptions(this, options);\n  },\n\n  _parseVisualVariables: function (visualVariables) {\n    var visVars = {};\n    if (visualVariables) {\n      for (var i = 0; i < visualVariables.length; i++) {\n        visVars[visualVariables[i].type] = visualVariables[i];\n      }\n    }\n    return visVars;\n  },\n\n  _createDefaultSymbol: function () {\n    if (this._rendererJson.defaultSymbol) {\n      this._defaultSymbol = this._newSymbol(this._rendererJson.defaultSymbol);\n      this._defaultSymbol._isDefault = true;\n    }\n  },\n\n  _newSymbol: function (symbolJson) {\n    if (symbolJson.type === 'esriSMS' || symbolJson.type === 'esriPMS') {\n      this._pointSymbols = true;\n      return pointSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSLS') {\n      return lineSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSFS') {\n      return polygonSymbol(symbolJson, this.options);\n    }\n  },\n\n  _getSymbol: function () {\n    // override\n  },\n\n  attachStylesToLayer: function (layer) {\n    if (this._pointSymbols) {\n      layer.options.pointToLayer = L.Util.bind(this.pointToLayer, this);\n    } else {\n      layer.options.style = L.Util.bind(this.style, this);\n      layer._originalStyle = layer.options.style;\n    }\n  },\n\n  pointToLayer: function (geojson, latlng) {\n    var sym = this._getSymbol(geojson);\n    if (sym && sym.pointToLayer) {\n      // right now custom panes are the only option pushed through\n      return sym.pointToLayer(geojson, latlng, this._visualVariables, this.options);\n    }\n    // invisible symbology\n    return L.circleMarker(latlng, {radius: 0, opacity: 0});\n  },\n\n  style: function (feature) {\n    var userStyles;\n    if (this.options.userDefinedStyle) {\n      userStyles = this.options.userDefinedStyle(feature);\n    }\n    // find the symbol to represent this feature\n    var sym = this._getSymbol(feature);\n    if (sym) {\n      return this.mergeStyles(sym.style(feature, this._visualVariables), userStyles);\n    } else {\n      // invisible symbology\n      return this.mergeStyles({opacity: 0, fillOpacity: 0}, userStyles);\n    }\n  },\n\n  mergeStyles: function (styles, userStyles) {\n    var mergedStyles = {};\n    var attr;\n    // copy renderer style attributes\n    for (attr in styles) {\n      if (styles.hasOwnProperty(attr)) {\n        mergedStyles[attr] = styles[attr];\n      }\n    }\n    // override with user defined style attributes\n    if (userStyles) {\n      for (attr in userStyles) {\n        if (userStyles.hasOwnProperty(attr)) {\n          mergedStyles[attr] = userStyles[attr];\n        }\n      }\n    }\n    return mergedStyles;\n  }\n});\n\nexport default Renderer;\n"],"names":["pointsEqual","a","b","i","length","closeRing","coordinates","push","ringIsClockwise","ringToTest","pt2","total","rLength","pt1","vertexIntersectsVertex","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","arrayIntersectsArray","j","coordinatesContainPoint","point","contains","l","coordinatesContainCoordinates","outer","inner","intersects","convertRingsToGeoJSON","rings","x","outerRing","hole","outerRings","holes","r","ring","slice","polygon","uncontainedHoles","pop","contained","reverse","type","shallowClone","obj","target","hasOwnProperty","arcgisToGeoJSON","arcgis","idAttribute","geojson","y","points","paths","geometry","attributes","properties","id","OBJECTID","FID","JSON","stringify","pointSymbol","symbolJson","options","PointSymbol","lineSymbol","LineSymbol","polygonSymbol","PolygonSymbol","classBreaksRenderer","rendererJson","ClassBreaksRenderer","uniqueValueRenderer","UniqueValueRenderer","simpleRenderer","SimpleRenderer","setRenderer","layerDefinition","layer","rend","rendererInfo","drawingInfo","renderer","pane","transparency","layerTransparency","style","userDefinedStyle","checkForProportionalSymbols","geometryType","_hasProportionalSymbols","_createPointLayer","attachStylesToLayer","_pointLayer","proportionalPolygon","console","log","backgroundFillSymbol","classBreakInfos","sym","symbol","featureCollection","FeatureCollection","csvLayer","CSVLayer","kmlLayer","KMLLayer","labelIcon","LabelIcon","labelMarker","latlng","LabelMarker","pointLabelPos","labelPos","position","offset","polylineLabelPos","centralKey","Math","round","polygonLabelPos","getBounds","getCenter","format","dirtyDate","dirtyFormatStr","dirtyOptions","formatStr","String","locale","localeFormatters","enLocale","formatters","formattingTokensRegExp","date","parse","isValid","buildFormatFn","formatter","array","match","removeFormattingTokens","output","Function","input","replace","formatTimezone","delimeter","sign","absOffset","abs","hours","floor","minutes","addLeadingZeros","number","targetLength","toString","transformPhoneNumber","value","s2","m","transformDate","createPopupContent","popupInfo","titleText","content","undefined","title","s","exec","contentStart","contentMiddle","fieldInfos","visible","fieldName","label","includes","description","descriptionText","operationalLayer","layers","map","params","paneName","_generateEsriLayer","lyr","labelsLayer","len","labels","labelPaneName","createPane","labelingInfo","itemId","featureSet","features","L","featureGroup","fc","data","opacity","onEachFeature","feature","layerName","split","popupContent","popupHtml","zIndexOffset","addLayer","layerGroup","layerType","where","gradient","colorStops","stop","ratio","color","esri","Heat","heatmapFeatureLayer","url","token","minOpacity","max","maxPixelIntensity","blur","blurRadius","radius","definitionExpression","featureLayer","locationInfo","kml","imageMapLayer","dynamicMapLayer","basemapLayer","e","tiledMapLayer","request","err","res","maxWidth","getSize","tiledAttribution","copyrightText","attributionControl","addAttribution","document","getElementsByClassName","keys","World Street Map (with Relief)","World Street Map (with Relief) (Mature Support)","Hybrid Reference Layer","Hybrid Reference Layer (Mature Support)","World Street Map","World Street Map (Mature Support)","World Street Map (Night)","World Street Map (Night) (Mature Support)","Dark Gray Canvas","Dark Gray Canvas (Mature Support)","World Topographic Map","World Topographic Map (Mature Support)","World Navigation Map","World Navigation Map (Mature Support)","Light Gray Canvas","Light Gray Canvas (Mature Support)","Vector","basemap","error","tileLayer","attribution","lyrUrl","_esriWTLUrlTemplateToLeaflet","templateUrl","copyright","layerNames","visibleLayers","wms","transparent","newUrl","webMap","webmapId","WebMap","Symbol","Class","extend","initialize","this","_symbolJson","val","_styles","_isDefault","_layerTransparency","pixelValue","pointValue","colorValue","alphaValue","sizeInfo","attr","field","size","featureValue","featureRatio","minSize","maxSize","minDataValue","maxDataValue","normField","normalizationField","normValue","parseFloat","isNaN","getColor","colorInfo","stops","lowerBoundColor","upperBoundColor","lowerBound","upperBound","lastStop","stopInfo","range","upperBoundColorWeight","lowerBoundColorWeight","interpolatedColor","ShapeMarker","Path","setOptions","_size","_latlng","latLng","_svgCanvasIncludes","toGeoJSON","GeoJSON","getFeature","latLngToCoords","getLatLng","_project","_point","_map","latLngToLayerPoint","_update","_updatePath","setLatLng","redraw","fire","setSize","CrossMarker","prototype","call","_renderer","_updateCrossMarker","Canvas","include","ctx","_ctx","beginPath","moveTo","lineTo","_fillStroke","SVG","Browser","vml","_round","str","_setPath","crossMarker","XMarker","_updateXMarker","xMarker","SquareMarker","fill","_updateSquareMarker","closePath","svg","squareMarker","DiamondMarker","_updateDiamondMarker","diamondMarker","statics","MARKERTYPES","serviceUrl","imageUrl","substr","sanitize","_iconUrl","imageData","contentType","_icons","icon","_createIcon","_fillStyles","text","ex","outline","stroke","weight","width","fillColor","fillOpacity","height","xOffset","yOffset","xoffset","yoffset","iconUrl","iconSize","iconAnchor","_getIcon","pointToLayer","visualVariables","calculatedSize","layerOptions","marker","circleMarker","LINETYPES","lineCap","lineJoin","dashValues","dashArray","join","POLYGONTYPES","_lineStyles","styleAttr","indexOf","Renderer","clickable","_rendererJson","_pointSymbols","_symbols","_visualVariables","_parseVisualVariables","Util","visVars","_createDefaultSymbol","defaultSymbol","_defaultSymbol","_newSymbol","_getSymbol","bind","_originalStyle","userStyles","mergeStyles","styles","mergedStyles","_field","normalizationType","_normalizationField","_createSymbols","classbreaks","classMaxValue","sort","_maxValue","field1","uniques","uniqueValueInfos","fieldDelimiter","field2","val2","val3","field3","_createSymbol","_layers","_getFeatureCollection","_parseFeatureCollection","index","objectIdField","extent","spatialReference","wkid","_projTo4326","_featureCollectionToGeoJSON","addData","projFeatures","mercatorToLatlng","k","f","Projection","SphericalMercator","unproject","lng","lat","plen","pathlen","pathslen","ringlen","ringslen","geojsonFeatureCollection","featuresArray","_parseCSV","omnivore","csv","latfield","latitudeFieldName","lonfield","longitudeFieldName","_getKML","requestUrl","DivIcon","className","createIcon","oldIcon","div","tagName","createElement","innerHTML","fontSize","fontWeight","textTransform","textAlign","whiteSpace","bgPos","backgroundPosition","_setIconStyles","Marker","labelText","_createLabelText","_setLabelIcon","labelExpression","setIcon","getDayOfYear","require","getISOWeek","getISOYear","M","getMonth","MM","Q","ceil","D","getDate","DD","DDD","DDDD","d","getDay","E","W","WW","YY","getFullYear","YYYY","GG","GGGG","H","getHours","HH","h","hh","getMinutes","mm","getSeconds","ss","S","getMilliseconds","SS","SSS","Z","getTimezoneOffset","ZZ","X","getTime","module","exports","Evented","server","_token","_server","_webmapId","_loaded","_metadataLoaded","_loadedLayersNum","_layersNum","bookmarks","portalItem","VERSION","_loadWebMapMetaData","_loadWebMap","_checkLoaded","_operationalLayer","visibility","addTo","webmap","webmapMetaDataRequestUrl","response","fitBounds","webmapRequestUrl","baseMap","baseMapLayers","operationalLayers","baseMapLayer","itemRequestUrl","access","bookmark","northEast","xmax","ymax","southWest","xmin","ymin","bounds","latLngBounds","name"],"mappings":"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"}