{"version":3,"file":null,"sources":["../node_modules/arcgis-to-geojson-utils/index.js","../node_modules/esri-leaflet-renderers/src/Symbols/PointSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/LineSymbol.js","../node_modules/esri-leaflet-renderers/src/Symbols/PolygonSymbol.js","../node_modules/esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/UniqueValueRenderer.js","../node_modules/esri-leaflet-renderers/src/Renderers/SimpleRenderer.js","../src/FeatureCollection/Renderer.js","../src/FeatureCollection/FeatureCollection.js","../src/FeatureCollection/CSVLayer.js","../src/FeatureCollection/KMLLayer.js","../src/Label/LabelIcon.js","../src/Label/LabelMarker.js","../src/Label/PointLabel.js","../src/Label/PolylineLabel.js","../src/Label/PolygonLabel.js","../src/Popup/Popup.js","../src/OperationalLayer.js","../src/WebMapLoader.js","../node_modules/esri-leaflet-renderers/src/Symbols/Symbol.js","../node_modules/leaflet-shape-markers/src/ShapeMarker.js","../node_modules/leaflet-shape-markers/src/CrossMarker.js","../node_modules/leaflet-shape-markers/src/XMarker.js","../node_modules/leaflet-shape-markers/src/SquareMarker.js","../node_modules/leaflet-shape-markers/src/DiamondMarker.js","../node_modules/esri-leaflet-renderers/src/Renderers/Renderer.js","../node_modules/date-fns/index.js"],"sourcesContent":["/*\n * Copyright 2017 Esri\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// checks if 2 x,y points are equal\nfunction pointsEqual (a, b) {\n  for (var i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// checks if the first and last points of a ring are equal and closes the ring\nfunction closeRing (coordinates) {\n  if (!pointsEqual(coordinates[0], coordinates[coordinates.length - 1])) {\n    coordinates.push(coordinates[0]);\n  }\n  return coordinates;\n}\n\n// determine if polygon ring coordinates are clockwise. clockwise signifies outer ring, counter-clockwise an inner ring\n// or hole. this logic was found at http://stackoverflow.com/questions/1165647/how-to-determine-if-a-list-of-polygon-\n// points-are-in-clockwise-order\nfunction ringIsClockwise (ringToTest) {\n  var total = 0;\n  var i = 0;\n  var rLength = ringToTest.length;\n  var pt1 = ringToTest[i];\n  var pt2;\n  for (i; i < rLength - 1; i++) {\n    pt2 = ringToTest[i + 1];\n    total += (pt2[0] - pt1[0]) * (pt2[1] + pt1[1]);\n    pt1 = pt2;\n  }\n  return (total >= 0);\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L504-L519\nfunction vertexIntersectsVertex (a1, a2, b1, b2) {\n  var uaT = ((b2[0] - b1[0]) * (a1[1] - b1[1])) - ((b2[1] - b1[1]) * (a1[0] - b1[0]));\n  var ubT = ((a2[0] - a1[0]) * (a1[1] - b1[1])) - ((a2[1] - a1[1]) * (a1[0] - b1[0]));\n  var uB = ((b2[1] - b1[1]) * (a2[0] - a1[0])) - ((b2[0] - b1[0]) * (a2[1] - a1[1]));\n\n  if (uB !== 0) {\n    var ua = uaT / uB;\n    var ub = ubT / uB;\n\n    if (ua >= 0 && ua <= 1 && ub >= 0 && ub <= 1) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L521-L531\nfunction arrayIntersectsArray (a, b) {\n  for (var i = 0; i < a.length - 1; i++) {\n    for (var j = 0; j < b.length - 1; j++) {\n      if (vertexIntersectsVertex(a[i], a[i + 1], b[j], b[j + 1])) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// ported from terraformer.js https://github.com/Esri/Terraformer/blob/master/terraformer.js#L470-L480\nfunction coordinatesContainPoint (coordinates, point) {\n  var contains = false;\n  for (var i = -1, l = coordinates.length, j = l - 1; ++i < l; j = i) {\n    if (((coordinates[i][1] <= point[1] && point[1] < coordinates[j][1]) ||\n         (coordinates[j][1] <= point[1] && point[1] < coordinates[i][1])) &&\n        (point[0] < (((coordinates[j][0] - coordinates[i][0]) * (point[1] - coordinates[i][1])) / (coordinates[j][1] - coordinates[i][1])) + coordinates[i][0])) {\n      contains = !contains;\n    }\n  }\n  return contains;\n}\n\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L106-L113\nfunction coordinatesContainCoordinates (outer, inner) {\n  var intersects = arrayIntersectsArray(outer, inner);\n  var contains = coordinatesContainPoint(outer, inner[0]);\n  if (!intersects && contains) {\n    return true;\n  }\n  return false;\n}\n\n// do any polygons in this array contain any other polygons in this array?\n// used for checking for holes in arcgis rings\n// ported from terraformer-arcgis-parser.js https://github.com/Esri/terraformer-arcgis-parser/blob/master/terraformer-arcgis-parser.js#L117-L172\nfunction convertRingsToGeoJSON (rings) {\n  var outerRings = [];\n  var holes = [];\n  var x; // iterator\n  var outerRing; // current outer ring being evaluated\n  var hole; // current hole being evaluated\n\n  // for each ring\n  for (var r = 0; r < rings.length; r++) {\n    var ring = closeRing(rings[r].slice(0));\n    if (ring.length < 4) {\n      continue;\n    }\n    // is this ring an outer ring? is it clockwise?\n    if (ringIsClockwise(ring)) {\n      var polygon = [ ring ];\n      outerRings.push(polygon); // push to outer rings\n    } else {\n      holes.push(ring); // counterclockwise push to holes\n    }\n  }\n\n  var uncontainedHoles = [];\n\n  // while there are holes left...\n  while (holes.length) {\n    // pop a hole off out stack\n    hole = holes.pop();\n\n    // loop over all outer rings and see if they contain our hole.\n    var contained = false;\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (coordinatesContainCoordinates(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        contained = true;\n        break;\n      }\n    }\n\n    // ring is not contained in any outer ring\n    // sometimes this happens https://github.com/Esri/esri-leaflet/issues/320\n    if (!contained) {\n      uncontainedHoles.push(hole);\n    }\n  }\n\n  // if we couldn't match any holes using contains we can try intersects...\n  while (uncontainedHoles.length) {\n    // pop a hole off out stack\n    hole = uncontainedHoles.pop();\n\n    // loop over all outer rings and see if any intersect our hole.\n    var intersects = false;\n\n    for (x = outerRings.length - 1; x >= 0; x--) {\n      outerRing = outerRings[x][0];\n      if (arrayIntersectsArray(outerRing, hole)) {\n        // the hole is contained push it into our polygon\n        outerRings[x].push(hole);\n        intersects = true;\n        break;\n      }\n    }\n\n    if (!intersects) {\n      outerRings.push([hole.reverse()]);\n    }\n  }\n\n  if (outerRings.length === 1) {\n    return {\n      type: 'Polygon',\n      coordinates: outerRings[0]\n    };\n  } else {\n    return {\n      type: 'MultiPolygon',\n      coordinates: outerRings\n    };\n  }\n}\n\n// This function ensures that rings are oriented in the right directions\n// outer rings are clockwise, holes are counterclockwise\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction orientRings (poly) {\n  var output = [];\n  var polygon = poly.slice(0);\n  var outerRing = closeRing(polygon.shift().slice(0));\n  if (outerRing.length >= 4) {\n    if (!ringIsClockwise(outerRing)) {\n      outerRing.reverse();\n    }\n\n    output.push(outerRing);\n\n    for (var i = 0; i < polygon.length; i++) {\n      var hole = closeRing(polygon[i].slice(0));\n      if (hole.length >= 4) {\n        if (ringIsClockwise(hole)) {\n          hole.reverse();\n        }\n        output.push(hole);\n      }\n    }\n  }\n\n  return output;\n}\n\n// This function flattens holes in multipolygons to one array of polygons\n// used for converting GeoJSON Polygons to ArcGIS Polygons\nfunction flattenMultiPolygonRings (rings) {\n  var output = [];\n  for (var i = 0; i < rings.length; i++) {\n    var polygon = orientRings(rings[i]);\n    for (var x = polygon.length - 1; x >= 0; x--) {\n      var ring = polygon[x].slice(0);\n      output.push(ring);\n    }\n  }\n  return output;\n}\n\n// shallow object clone for feature properties and attributes\n// from http://jsperf.com/cloning-an-object/2\nfunction shallowClone (obj) {\n  var target = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      target[i] = obj[i];\n    }\n  }\n  return target;\n}\n\nexport function arcgisToGeoJSON (arcgis, idAttribute) {\n  var geojson = {};\n\n  if (typeof arcgis.x === 'number' && typeof arcgis.y === 'number') {\n    geojson.type = 'Point';\n    geojson.coordinates = [arcgis.x, arcgis.y];\n  }\n\n  if (arcgis.points) {\n    geojson.type = 'MultiPoint';\n    geojson.coordinates = arcgis.points.slice(0);\n  }\n\n  if (arcgis.paths) {\n    if (arcgis.paths.length === 1) {\n      geojson.type = 'LineString';\n      geojson.coordinates = arcgis.paths[0].slice(0);\n    } else {\n      geojson.type = 'MultiLineString';\n      geojson.coordinates = arcgis.paths.slice(0);\n    }\n  }\n\n  if (arcgis.rings) {\n    geojson = convertRingsToGeoJSON(arcgis.rings.slice(0));\n  }\n\n  if (arcgis.geometry || arcgis.attributes) {\n    geojson.type = 'Feature';\n    geojson.geometry = (arcgis.geometry) ? arcgisToGeoJSON(arcgis.geometry) : null;\n    geojson.properties = (arcgis.attributes) ? shallowClone(arcgis.attributes) : null;\n    if (arcgis.attributes) {\n      geojson.id = arcgis.attributes[idAttribute] || arcgis.attributes.OBJECTID || arcgis.attributes.FID;\n    }\n  }\n\n  // if no valid geometry was encountered\n  if (JSON.stringify(geojson.geometry) === JSON.stringify({})) {\n    geojson.geometry = null;\n  }\n\n  return geojson;\n}\n\nexport function geojsonToArcGIS (geojson, idAttribute) {\n  idAttribute = idAttribute || 'OBJECTID';\n  var spatialReference = { wkid: 4326 };\n  var result = {};\n  var i;\n\n  switch (geojson.type) {\n    case 'Point':\n      result.x = geojson.coordinates[0];\n      result.y = geojson.coordinates[1];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPoint':\n      result.points = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'LineString':\n      result.paths = [geojson.coordinates.slice(0)];\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiLineString':\n      result.paths = geojson.coordinates.slice(0);\n      result.spatialReference = spatialReference;\n      break;\n    case 'Polygon':\n      result.rings = orientRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'MultiPolygon':\n      result.rings = flattenMultiPolygonRings(geojson.coordinates.slice(0));\n      result.spatialReference = spatialReference;\n      break;\n    case 'Feature':\n      if (geojson.geometry) {\n        result.geometry = geojsonToArcGIS(geojson.geometry, idAttribute);\n      }\n      result.attributes = (geojson.properties) ? shallowClone(geojson.properties) : {};\n      if (geojson.id) {\n        result.attributes[idAttribute] = geojson.id;\n      }\n      break;\n    case 'FeatureCollection':\n      result = [];\n      for (i = 0; i < geojson.features.length; i++) {\n        result.push(geojsonToArcGIS(geojson.features[i], idAttribute));\n      }\n      break;\n    case 'GeometryCollection':\n      result = [];\n      for (i = 0; i < geojson.geometries.length; i++) {\n        result.push(geojsonToArcGIS(geojson.geometries[i], idAttribute));\n      }\n      break;\n  }\n\n  return result;\n}\n\nexport default { arcgisToGeoJSON, geojsonToArcGIS };\n","import L from 'leaflet';\nimport Symbol from './Symbol';\nimport {squareMarker, xMarker, crossMarker, diamondMarker} from 'leaflet-shape-markers';\n\nexport var PointSymbol = Symbol.extend({\n\n  statics: {\n    MARKERTYPES: ['esriSMSCircle', 'esriSMSCross', 'esriSMSDiamond', 'esriSMSSquare', 'esriSMSX', 'esriPMS']\n  },\n\n  initialize: function (symbolJson, options) {\n    var url;\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (options) {\n      this.serviceUrl = options.url;\n    }\n    if (symbolJson) {\n      if (symbolJson.type === 'esriPMS') {\n        var imageUrl = this._symbolJson.url;\n        if ((imageUrl && imageUrl.substr(0, 7) === 'http://') || (imageUrl.substr(0, 8) === 'https://')) {\n          // web image\n          url = this.sanitize(imageUrl);\n          this._iconUrl = url;\n        } else {\n          url = this.serviceUrl + 'images/' + imageUrl;\n          this._iconUrl = options && options.token ? url + '?token=' + options.token : url;\n        }\n        if (symbolJson.imageData) {\n          this._iconUrl = 'data:' + symbolJson.contentType + ';base64,' + symbolJson.imageData;\n        }\n        // leaflet does not allow resizing icons so keep a hash of different\n        // icon sizes to try and keep down on the number of icons created\n        this._icons = {};\n        // create base icon\n        this.icon = this._createIcon(this._symbolJson);\n      } else {\n        this._fillStyles();\n      }\n    }\n  },\n\n  // prevent html injection in strings\n  sanitize: function (str) {\n    if (!str) {\n      return '';\n    }\n    var text;\n    try {\n      // removes html but leaves url link text\n      text = str.replace(/<br>/gi, '\\n');\n      text = text.replace(/<p.*>/gi, '\\n');\n      text = text.replace(/<a.*href='(.*?)'.*>(.*?)<\\/a>/gi, ' $2 ($1) ');\n      text = text.replace(/<(?:.|\\s)*?>/g, '');\n    } catch (ex) {\n      text = null;\n    }\n    return text;\n  },\n\n  _fillStyles: function () {\n    if (this._symbolJson.outline && this._symbolJson.size > 0 && this._symbolJson.outline.style !== 'esriSLSNull') {\n      this._styles.stroke = true;\n      this._styles.weight = this.pixelValue(this._symbolJson.outline.width);\n      this._styles.color = this.colorValue(this._symbolJson.outline.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.outline.color);\n    } else {\n      this._styles.stroke = false;\n    }\n    if (this._symbolJson.color) {\n      this._styles.fillColor = this.colorValue(this._symbolJson.color);\n      this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n    } else {\n      this._styles.fillOpacity = 0;\n    }\n\n    if (this._symbolJson.style === 'esriSMSCircle') {\n      this._styles.radius = this.pixelValue(this._symbolJson.size) / 2.0;\n    }\n  },\n\n  _createIcon: function (options) {\n    var width = this.pixelValue(options.width);\n    var height = width;\n    if (options.height) {\n      height = this.pixelValue(options.height);\n    }\n    var xOffset = width / 2.0;\n    var yOffset = height / 2.0;\n\n    if (options.xoffset) {\n      xOffset += this.pixelValue(options.xoffset);\n    }\n    if (options.yoffset) {\n      yOffset += this.pixelValue(options.yoffset);\n    }\n\n    var icon = L.icon({\n      iconUrl: this._iconUrl,\n      iconSize: [width, height],\n      iconAnchor: [xOffset, yOffset]\n    });\n    this._icons[options.width.toString()] = icon;\n    return icon;\n  },\n\n  _getIcon: function (size) {\n    // check to see if it is already created by size\n    var icon = this._icons[size.toString()];\n    if (!icon) {\n      icon = this._createIcon({width: size});\n    }\n    return icon;\n  },\n\n  pointToLayer: function (geojson, latlng, visualVariables, options) {\n    var size = this._symbolJson.size || this._symbolJson.width;\n    if (!this._isDefault) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.getSize(geojson, visualVariables.sizeInfo);\n        if (calculatedSize) {\n          size = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(geojson, visualVariables.colorInfo);\n        if (color) {\n          this._styles.fillColor = this.colorValue(color);\n          this._styles.fillOpacity = this.alphaValue(color);\n        }\n      }\n    }\n\n    if (this._symbolJson.type === 'esriPMS') {\n      var layerOptions = L.extend({}, {icon: this._getIcon(size)}, options);\n      return L.marker(latlng, layerOptions);\n    }\n    size = this.pixelValue(size);\n\n    switch (this._symbolJson.style) {\n      case 'esriSMSSquare':\n        return squareMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSDiamond':\n        return diamondMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSCross':\n        return crossMarker(latlng, size, L.extend({}, this._styles, options));\n      case 'esriSMSX':\n        return xMarker(latlng, size, L.extend({}, this._styles, options));\n    }\n    this._styles.radius = size / 2.0;\n    return L.circleMarker(latlng, L.extend({}, this._styles, options));\n  }\n});\n\nexport function pointSymbol (symbolJson, options) {\n  return new PointSymbol(symbolJson, options);\n}\n\nexport default pointSymbol;\n","import Symbol from './Symbol';\n\nexport var LineSymbol = Symbol.extend({\n  statics: {\n    // Not implemented 'esriSLSNull'\n    LINETYPES: ['esriSLSDash', 'esriSLSDot', 'esriSLSDashDotDot', 'esriSLSDashDot', 'esriSLSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    this._fillStyles();\n  },\n\n  _fillStyles: function () {\n    // set the defaults that show up on arcgis online\n    this._styles.lineCap = 'butt';\n    this._styles.lineJoin = 'miter';\n    this._styles.fill = false;\n    this._styles.weight = 0;\n\n    if (!this._symbolJson) {\n      return this._styles;\n    }\n\n    if (this._symbolJson.color) {\n      this._styles.color = this.colorValue(this._symbolJson.color);\n      this._styles.opacity = this.alphaValue(this._symbolJson.color);\n    }\n\n    if (!isNaN(this._symbolJson.width)) {\n      this._styles.weight = this.pixelValue(this._symbolJson.width);\n\n      var dashValues = [];\n\n      switch (this._symbolJson.style) {\n        case 'esriSLSDash':\n          dashValues = [4, 3];\n          break;\n        case 'esriSLSDot':\n          dashValues = [1, 3];\n          break;\n        case 'esriSLSDashDot':\n          dashValues = [8, 3, 1, 3];\n          break;\n        case 'esriSLSDashDotDot':\n          dashValues = [8, 3, 1, 3, 1, 3];\n          break;\n      }\n\n      // use the dash values and the line weight to set dash array\n      if (dashValues.length > 0) {\n        for (var i = 0; i < dashValues.length; i++) {\n          dashValues[i] *= this._styles.weight;\n        }\n\n        this._styles.dashArray = dashValues.join(',');\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables) {\n      if (visualVariables.sizeInfo) {\n        var calculatedSize = this.pixelValue(this.getSize(feature, visualVariables.sizeInfo));\n        if (calculatedSize) {\n          this._styles.weight = calculatedSize;\n        }\n      }\n      if (visualVariables.colorInfo) {\n        var color = this.getColor(feature, visualVariables.colorInfo);\n        if (color) {\n          this._styles.color = this.colorValue(color);\n          this._styles.opacity = this.alphaValue(color);\n        }\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function lineSymbol (symbolJson, options) {\n  return new LineSymbol(symbolJson, options);\n}\n\nexport default lineSymbol;\n","import Symbol from './Symbol';\nimport lineSymbol from './LineSymbol';\n\nexport var PolygonSymbol = Symbol.extend({\n  statics: {\n    // not implemented: 'esriSFSBackwardDiagonal','esriSFSCross','esriSFSDiagonalCross','esriSFSForwardDiagonal','esriSFSHorizontal','esriSFSNull','esriSFSVertical'\n    POLYGONTYPES: ['esriSFSSolid']\n  },\n  initialize: function (symbolJson, options) {\n    Symbol.prototype.initialize.call(this, symbolJson, options);\n    if (symbolJson) {\n      if (symbolJson.outline && symbolJson.outline.style === 'esriSLSNull') {\n        this._lineStyles = { weight: 0 };\n      } else {\n        this._lineStyles = lineSymbol(symbolJson.outline, options).style();\n      }\n      this._fillStyles();\n    }\n  },\n\n  _fillStyles: function () {\n    if (this._lineStyles) {\n      if (this._lineStyles.weight === 0) {\n        // when weight is 0, setting the stroke to false can still look bad\n        // (gaps between the polygons)\n        this._styles.stroke = false;\n      } else {\n        // copy the line symbol styles into this symbol's styles\n        for (var styleAttr in this._lineStyles) {\n          this._styles[styleAttr] = this._lineStyles[styleAttr];\n        }\n      }\n    }\n\n    // set the fill for the polygon\n    if (this._symbolJson) {\n      if (this._symbolJson.color &&\n          // don't fill polygon if type is not supported\n          PolygonSymbol.POLYGONTYPES.indexOf(this._symbolJson.style >= 0)) {\n        this._styles.fill = true;\n        this._styles.fillColor = this.colorValue(this._symbolJson.color);\n        this._styles.fillOpacity = this.alphaValue(this._symbolJson.color);\n      } else {\n        this._styles.fill = false;\n        this._styles.fillOpacity = 0;\n      }\n    }\n  },\n\n  style: function (feature, visualVariables) {\n    if (!this._isDefault && visualVariables && visualVariables.colorInfo) {\n      var color = this.getColor(feature, visualVariables.colorInfo);\n      if (color) {\n        this._styles.fillColor = this.colorValue(color);\n        this._styles.fillOpacity = this.alphaValue(color);\n      }\n    }\n    return this._styles;\n  }\n});\n\nexport function polygonSymbol (symbolJson, options) {\n  return new PolygonSymbol(symbolJson, options);\n}\n\nexport default polygonSymbol;\n","import Renderer from './Renderer';\n\nexport var ClassBreaksRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field;\n    if (this._rendererJson.normalizationType && this._rendererJson.normalizationType === 'esriNormalizeByField') {\n      this._normalizationField = this._rendererJson.normalizationField;\n    }\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var classbreaks = this._rendererJson.classBreakInfos;\n\n    this._symbols = [];\n\n    // create a symbol for each class break\n    for (var i = classbreaks.length - 1; i >= 0; i--) {\n      if (this.options.proportionalPolygon && this._rendererJson.backgroundFillSymbol) {\n        symbol = this._newSymbol(this._rendererJson.backgroundFillSymbol);\n      } else {\n        symbol = this._newSymbol(classbreaks[i].symbol);\n      }\n      symbol.val = classbreaks[i].classMaxValue;\n      this._symbols.push(symbol);\n    }\n    // sort the symbols in ascending value\n    this._symbols.sort(function (a, b) {\n      return a.val > b.val ? 1 : -1;\n    });\n    this._createDefaultSymbol();\n    this._maxValue = this._symbols[this._symbols.length - 1].val;\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    if (this._normalizationField) {\n      var normValue = feature.properties[this._normalizationField];\n      if (!isNaN(normValue) && normValue !== 0) {\n        val = val / normValue;\n      } else {\n        return this._defaultSymbol;\n      }\n    }\n\n    if (val > this._maxValue) {\n      return this._defaultSymbol;\n    }\n    var symbol = this._symbols[0];\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      if (val > this._symbols[i].val) {\n        break;\n      }\n      symbol = this._symbols[i];\n    }\n    return symbol;\n  }\n});\n\nexport function classBreaksRenderer (rendererJson, options) {\n  return new ClassBreaksRenderer(rendererJson, options);\n}\n\nexport default classBreaksRenderer;\n","import Renderer from './Renderer';\n\nexport var UniqueValueRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._field = this._rendererJson.field1;\n    this._createSymbols();\n  },\n\n  _createSymbols: function () {\n    var symbol;\n    var uniques = this._rendererJson.uniqueValueInfos;\n\n    // create a symbol for each unique value\n    for (var i = uniques.length - 1; i >= 0; i--) {\n      symbol = this._newSymbol(uniques[i].symbol);\n      symbol.val = uniques[i].value;\n      this._symbols.push(symbol);\n    }\n    this._createDefaultSymbol();\n  },\n\n  _getSymbol: function (feature) {\n    var val = feature.properties[this._field];\n    // accumulate values if there is more than one field defined\n    if (this._rendererJson.fieldDelimiter && this._rendererJson.field2) {\n      var val2 = feature.properties[this._rendererJson.field2];\n      if (val2) {\n        val += this._rendererJson.fieldDelimiter + val2;\n        var val3 = feature.properties[this._rendererJson.field3];\n        if (val3) {\n          val += this._rendererJson.fieldDelimiter + val3;\n        }\n      }\n    }\n\n    var symbol = this._defaultSymbol;\n    for (var i = this._symbols.length - 1; i >= 0; i--) {\n      // using the === operator does not work if the field\n      // of the unique renderer is not a string\n      /*eslint-disable */\n      if (this._symbols[i].val == val) {\n        symbol = this._symbols[i];\n      }\n      /*eslint-enable */\n    }\n    return symbol;\n  }\n});\n\nexport function uniqueValueRenderer (rendererJson, options) {\n  return new UniqueValueRenderer(rendererJson, options);\n}\n\nexport default uniqueValueRenderer;\n","import Renderer from './Renderer';\n\nexport var SimpleRenderer = Renderer.extend({\n  initialize: function (rendererJson, options) {\n    Renderer.prototype.initialize.call(this, rendererJson, options);\n    this._createSymbol();\n  },\n\n  _createSymbol: function () {\n    if (this._rendererJson.symbol) {\n      this._symbols.push(this._newSymbol(this._rendererJson.symbol));\n    }\n  },\n\n  _getSymbol: function () {\n    return this._symbols[0];\n  }\n});\n\nexport function simpleRenderer (rendererJson, options) {\n  return new SimpleRenderer(rendererJson, options);\n}\n\nexport default simpleRenderer;\n","import { classBreaksRenderer } from 'esri-leaflet-renderers/src/Renderers/ClassBreaksRenderer';\r\nimport { uniqueValueRenderer } from 'esri-leaflet-renderers/src/Renderers/UniqueValueRenderer';\r\nimport { simpleRenderer } from 'esri-leaflet-renderers/src/Renderers/SimpleRenderer';\r\n\r\nexport function setRenderer (layerDefinition, layer) {\r\n  var rend;\r\n  var rendererInfo = layerDefinition.drawingInfo.renderer;\r\n\r\n  var options = {};\r\n\r\n  if (layer.options.pane) {\r\n    options.pane = layer.options.pane;\r\n  }\r\n  if (layerDefinition.drawingInfo.transparency) {\r\n    options.layerTransparency = layerDefinition.drawingInfo.transparency;\r\n  }\r\n  if (layer.options.style) {\r\n    options.userDefinedStyle = layer.options.style;\r\n  }\r\n\r\n  switch (rendererInfo.type) {\r\n    case 'classBreaks':\r\n      checkForProportionalSymbols(layerDefinition.geometryType, rendererInfo, layer);\r\n      if (layer._hasProportionalSymbols) {\r\n        layer._createPointLayer();\r\n        var pRend = classBreaksRenderer(rendererInfo, options);\r\n        pRend.attachStylesToLayer(layer._pointLayer);\r\n        options.proportionalPolygon = true;\r\n      }\r\n      rend = classBreaksRenderer(rendererInfo, options);\r\n      break;\r\n    case 'uniqueValue':\r\n      console.log(rendererInfo, options);\r\n      rend = uniqueValueRenderer(rendererInfo, options);\r\n      break;\r\n    default:\r\n      rend = simpleRenderer(rendererInfo, options);\r\n  }\r\n  rend.attachStylesToLayer(layer);\r\n}\r\n\r\nexport function checkForProportionalSymbols (geometryType, renderer, layer) {\r\n  layer._hasProportionalSymbols = false;\r\n  if (geometryType === 'esriGeometryPolygon') {\r\n    if (renderer.backgroundFillSymbol) {\r\n      layer._hasProportionalSymbols = true;\r\n    }\r\n    // check to see if the first symbol in the classbreaks is a marker symbol\r\n    if (renderer.classBreakInfos && renderer.classBreakInfos.length) {\r\n      var sym = renderer.classBreakInfos[0].symbol;\r\n      if (sym && (sym.type === 'esriSMS' || sym.type === 'esriPMS')) {\r\n        layer._hasProportionalSymbols = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport var Renderer = {\r\n  setRenderer: setRenderer,\r\n  checkForProportionalSymbols: checkForProportionalSymbols\r\n};\r\n\r\nexport default Renderer;\r\n","import L from 'leaflet';\r\n\r\nimport { arcgisToGeoJSON } from 'arcgis-to-geojson-utils';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var FeatureCollection = L.GeoJSON.extend({\r\n  options: {\r\n    data: {}, // Esri Feature Collection JSON or Item ID\r\n    opacity: 1\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.data = this.options.data;\r\n    this.opacity = this.options.opacity;\r\n    this.popupInfo = null;\r\n    this.labelingInfo = null;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    if (typeof this.data === 'string') {\r\n      this._getFeatureCollection(this.data);\r\n    } else {\r\n      this._parseFeatureCollection(this.data);\r\n    }\r\n  },\r\n\r\n  _getFeatureCollection: function (itemId) {\r\n    var url = 'https://www.arcgis.com/sharing/rest/content/items/' + itemId + '/data';\r\n    L.esri.request(url, {}, function (err, res) {\r\n      if (err) {\r\n        console.log(err);\r\n      } else {\r\n        this._parseFeatureCollection(res);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  _parseFeatureCollection: function (data) {\r\n    var i, len;\r\n    var index = 0;\r\n    for (i = 0, len = data.layers.length; i < len; i++) {\r\n      if (data.layers[i].featureSet.features.length > 0) {\r\n        index = i;\r\n      }\r\n    }\r\n    var features = data.layers[index].featureSet.features;\r\n    var geometryType = data.layers[index].layerDefinition.geometryType; // 'esriGeometryPoint' | 'esriGeometryMultipoint' | 'esriGeometryPolyline' | 'esriGeometryPolygon' | 'esriGeometryEnvelope'\r\n    var objectIdField = data.layers[index].layerDefinition.objectIdField;\r\n    var layerDefinition = data.layers[index].layerDefinition || null;\r\n\r\n    if (data.layers[index].layerDefinition.extent.spatialReference.wkid !== 4326) {\r\n      if (data.layers[index].layerDefinition.extent.spatialReference.wkid !== 102100) {\r\n        console.error('[L.esri.WebMap] this wkid (' + data.layers[index].layerDefinition.extent.spatialReference.wkid + ') is not supported.');\r\n      }\r\n      features = this._projTo4326(features, geometryType);\r\n    }\r\n    if (data.layers[index].popupInfo !== undefined) {\r\n      this.popupInfo = data.layers[index].popupInfo;\r\n    }\r\n    if (data.layers[index].layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n      this.labelingInfo = data.layers[index].layerDefinition.drawingInfo.labelingInfo;\r\n    }\r\n    console.log(data);\r\n\r\n    var geojson = this._featureCollectionToGeoJSON(features, objectIdField);\r\n\r\n    if (layerDefinition !== null) {\r\n      setRenderer(layerDefinition, this);\r\n    }\r\n    console.log(geojson);\r\n    this.addData(geojson);\r\n  },\r\n\r\n  _projTo4326: function (features, geometryType) {\r\n    console.log('_project!');\r\n    var i, len;\r\n    var projFeatures = [];\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var f = features[i];\r\n      var mercatorToLatlng;\r\n      var j, k;\r\n\r\n      if (geometryType === 'esriGeometryPoint') {\r\n        mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.x, f.geometry.y));\r\n        f.geometry.x = mercatorToLatlng.lng;\r\n        f.geometry.y = mercatorToLatlng.lat;\r\n      } else if (geometryType === 'esriGeometryMultipoint') {\r\n        var plen;\r\n\r\n        for (j = 0, plen = f.geometry.points.length; j < plen; j++) {\r\n          mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.points[j][0], f.geometry.points[j][1]));\r\n          f.geometry.points[j][0] = mercatorToLatlng.lng;\r\n          f.geometry.points[j][1] = mercatorToLatlng.lat;\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolyline') {\r\n        var pathlen, pathslen;\r\n\r\n        for (j = 0, pathslen = f.geometry.paths.length; j < pathslen; j++) {\r\n          for (k = 0, pathlen = f.geometry.paths[j].length; k < pathlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.paths[j][k][0], f.geometry.paths[j][k][1]));\r\n            f.geometry.paths[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.paths[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      } else if (geometryType === 'esriGeometryPolygon') {\r\n        var ringlen, ringslen;\r\n\r\n        for (j = 0, ringslen = f.geometry.rings.length; j < ringslen; j++) {\r\n          for (k = 0, ringlen = f.geometry.rings[j].length; k < ringlen; k++) {\r\n            mercatorToLatlng = L.Projection.SphericalMercator.unproject(L.point(f.geometry.rings[j][k][0], f.geometry.rings[j][k][1]));\r\n            f.geometry.rings[j][k][0] = mercatorToLatlng.lng;\r\n            f.geometry.rings[j][k][1] = mercatorToLatlng.lat;\r\n          }\r\n        }\r\n      }\r\n      projFeatures.push(f);\r\n    }\r\n\r\n    return projFeatures;\r\n  },\r\n\r\n  _featureCollectionToGeoJSON: function (features, objectIdField) {\r\n    var geojsonFeatureCollection = {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n    var featuresArray = [];\r\n    var i, len;\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var geojson = arcgisToGeoJSON(features[i], objectIdField);\r\n      featuresArray.push(geojson);\r\n    }\r\n\r\n    geojsonFeatureCollection.features = featuresArray;\r\n\r\n    return geojsonFeatureCollection;\r\n  }\r\n});\r\n\r\nexport function featureCollection (geojson, options) {\r\n  return new FeatureCollection(geojson, options);\r\n}\r\n\r\nexport default featureCollection;\r\n","import L from 'leaflet';\r\n\r\nimport omnivore from 'leaflet-omnivore';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var CSVLayer = L.GeoJSON.extend({\r\n  options: {\r\n    url: '',\r\n    data: {}, // Esri Feature Collection JSON or Item ID\r\n    opacity: 1\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.url = this.options.url;\r\n    this.layerDefinition = this.options.layerDefinition;\r\n    this.locationInfo = this.options.locationInfo;\r\n    this.opacity = this.options.opacity;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    this._parseCSV(this.url, this.layerDefinition, this.locationInfo);\r\n  },\r\n\r\n  _parseCSV: function (url, layerDefinition, locationInfo) {\r\n    omnivore.csv(url, {\r\n      latfield: locationInfo.latitudeFieldName,\r\n      lonfield: locationInfo.longitudeFieldName\r\n    }, this);\r\n\r\n    setRenderer(layerDefinition, this);\r\n  }\r\n});\r\n\r\nexport function csvLayer (geojson, options) {\r\n  return new CSVLayer(geojson, options);\r\n}\r\n\r\nexport default CSVLayer;\r\n","import L from 'leaflet';\r\n\r\nimport { arcgisToGeoJSON } from 'arcgis-to-geojson-utils';\r\nimport { setRenderer } from './Renderer';\r\n\r\nexport var KMLLayer = L.GeoJSON.extend({\r\n  options: {\r\n    opacity: 1,\r\n    url: ''\r\n  },\r\n\r\n  initialize: function (layers, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this.url = this.options.url;\r\n    this.opacity = this.options.opacity;\r\n    this.popupInfo = null;\r\n    this.labelingInfo = null;\r\n    this._layers = {};\r\n\r\n    var i, len;\r\n\r\n    if (layers) {\r\n      for (i = 0, len = layers.length; i < len; i++) {\r\n        this.addLayer(layers[i]);\r\n      }\r\n    }\r\n\r\n    this._getKML(this.url);\r\n  },\r\n\r\n  _getKML: function (url) {\r\n    var requestUrl = 'http://utility.arcgis.com/sharing/kml?url=' + url + '&model=simple&folders=&outSR=%7B\"wkid\"%3A4326%7D';\r\n    L.esri.request(requestUrl, {}, function (err, res) {\r\n      if (err) {\r\n        console.log(err);\r\n      } else {\r\n        console.log(res);\r\n        this._parseFeatureCollection(res.featureCollection);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  _parseFeatureCollection: function (featureCollection) {\r\n    console.log('_parseFeatureCollection');\r\n    var i;\r\n    for (i = 0; i < 3; i++) {\r\n      if (featureCollection.layers[i].featureSet.features.length > 0) {\r\n        console.log(i);\r\n        var features = featureCollection.layers[i].featureSet.features;\r\n        var objectIdField = featureCollection.layers[i].layerDefinition.objectIdField;\r\n\r\n        var geojson = this._featureCollectionToGeoJSON(features, objectIdField);\r\n\r\n        if (featureCollection.layers[i].popupInfo !== undefined) {\r\n          this.popupInfo = featureCollection.layers[i].popupInfo;\r\n        }\r\n        if (featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== undefined) {\r\n          this.labelingInfo = featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo;\r\n        }\r\n\r\n        setRenderer(featureCollection.layers[i].layerDefinition, this);\r\n        console.log(geojson);\r\n        this.addData(geojson);\r\n      }\r\n    }\r\n  },\r\n\r\n  _featureCollectionToGeoJSON: function (features, objectIdField) {\r\n    var geojsonFeatureCollection = {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n    var featuresArray = [];\r\n    var i, len;\r\n\r\n    for (i = 0, len = features.length; i < len; i++) {\r\n      var geojson = arcgisToGeoJSON(features[i], objectIdField);\r\n      featuresArray.push(geojson);\r\n    }\r\n\r\n    geojsonFeatureCollection.features = featuresArray;\r\n\r\n    return geojsonFeatureCollection;\r\n  }\r\n});\r\n\r\nexport function kmlLayer (geojson, options) {\r\n  return new KMLLayer(geojson, options);\r\n}\r\n\r\nexport default KMLLayer;\r\n","import L from 'leaflet';\r\n\r\nexport var LabelIcon = L.DivIcon.extend({\r\n  options: {\r\n    iconSize: null,\r\n    className: 'esri-leaflet-webmap-labels',\r\n    text: ''\r\n  },\r\n\r\n  createIcon: function (oldIcon) {\r\n    var div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div');\r\n    var options = this.options;\r\n\r\n    div.innerHTML = '<div style=\"position: relative; left: -50%; text-shadow: 1px 1px 0px #fff, -1px 1px 0px #fff, 1px -1px 0px #fff, -1px -1px 0px #fff;\">' + options.text + '</div>';\r\n\r\n    // label.css\r\n    div.style.fontSize = '1em';\r\n    div.style.fontWeight = 'bold';\r\n    div.style.textTransform = 'uppercase';\r\n    div.style.textAlign = 'center';\r\n    div.style.whiteSpace = 'nowrap';\r\n\r\n    if (options.bgPos) {\r\n      var bgPos = L.point(options.bgPos);\r\n      div.style.backgroundPosition = (-bgPos.x) + 'px ' + (-bgPos.y) + 'px';\r\n    }\r\n    this._setIconStyles(div, 'icon');\r\n\r\n    return div;\r\n  }\r\n});\r\n\r\nexport function labelIcon (options) {\r\n  return new LabelIcon(options);\r\n}\r\n\r\nexport default labelIcon;\r\n","import L from 'leaflet';\r\nimport { labelIcon } from './LabelIcon';\r\n\r\nexport var LabelMarker = L.Marker.extend({\r\n  options: {\r\n    properties: {},\r\n    labelingInfo: {},\r\n    offset: [0, 0]\r\n  },\r\n\r\n  initialize: function (latlng, options) {\r\n    L.setOptions(this, options);\r\n    this._latlng = L.latLng(latlng);\r\n\r\n    var labelText = this._createLabelText(this.options.properties, this.options.labelingInfo);\r\n    this._setLabelIcon(labelText, this.options.offset);\r\n  },\r\n\r\n  _createLabelText: function (properties, labelingInfo) {\r\n    var r = /\\[([^\\]]*)\\]/g;\r\n    var labelText = labelingInfo[0].labelExpression;\r\n\r\n    labelText = labelText.replace(r, function (s) {\r\n      var m = r.exec(s);\r\n      return properties[m[1]];\r\n    });\r\n\r\n    return labelText;\r\n  },\r\n\r\n  _setLabelIcon: function (text, offset) {\r\n    var icon = labelIcon({\r\n      text: text,\r\n      iconAnchor: offset\r\n    });\r\n\r\n    this.setIcon(icon);\r\n  }\r\n});\r\n\r\nexport function labelMarker (latlng, options) {\r\n  return new LabelMarker(latlng, options);\r\n}\r\n\r\nexport default labelMarker;\r\n","export function pointLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = coordinates.reverse();\r\n  labelPos.offset = [20, 20];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PointLabel = {\r\n  pointLabelPos: pointLabelPos\r\n};\r\n\r\nexport default PointLabel;\r\n","export function polylineLabelPos (coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n  var centralKey;\r\n\r\n  centralKey = Math.round(coordinates.length / 2);\r\n  labelPos.position = coordinates[centralKey].reverse();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolylineLabel = {\r\n  polylineLabelPos: polylineLabelPos\r\n};\r\n\r\nexport default PolylineLabel;\r\n","export function polygonLabelPos (layer, coordinates) {\r\n  var labelPos = { position: [], offset: [] };\r\n\r\n  labelPos.position = layer.getBounds().getCenter();\r\n  labelPos.offset = [0, 0];\r\n\r\n  return labelPos;\r\n}\r\n\r\nexport var PolygonLabel = {\r\n  polygonLabelPos: polygonLabelPos\r\n};\r\n\r\nexport default PolygonLabel;\r\n","import * as datefns from 'date-fns';\r\n\r\nfunction transformPhoneNumber(value) {\r\n  var s2 = (\"\"+value).replace(/\\D/g, '');\r\n  var m = s2.match(/^(\\d{3})(\\d{3})(\\d{4})$/);\r\n  return (!m) ? null : \"(\" + m[1] + \") \" + m[2] + \"-\" + m[3];\r\n}\r\n\r\nfunction transformDate(value) {\r\n  // var moment = globals.moment;\r\n  // return moment(value).format('MM/DD/YYYY');\r\n  return datefns.format(value, 'MM/DD/YYYY');\r\n  // return value;\r\n}\r\n\r\nfunction transformDecimalPlace(value) {\r\n  var number = String(value).match(/\\d+/)[0].replace(/(.)(?=(\\d{3})+$)/g,'$1,');\r\n  var label = String(value).replace(/[0-9]/g, '') || '';\r\n  return number + ' ' + label;\r\n}\r\n\r\n\r\nexport function createPopupContent (popupInfo, properties) {\r\n  // console.log('popupInfo:', popupInfo);\r\n  // console.log('popup properties:', properties);\r\n  var r = /\\{([^\\]]*)\\}/g;\r\n  var titleText = '';\r\n  var content = '';\r\n\r\n  if (popupInfo.title !== undefined) {\r\n    titleText = popupInfo.title;\r\n  }\r\n\r\n  titleText = titleText.replace(r, function (s) {\r\n    var m = r.exec(s);\r\n    return properties[m[1]];\r\n  });\r\n\r\n  content = '<div class=\"leaflet-popup-content-title text-center\"><h4>' + titleText + '</h4></div><div class=\"leaflet-popup-content-description\" style=\"max-height:200px;overflow:auto;\">';\r\n\r\n  var contentStart = '<div style=\"font-weight:bold;color:#999;margin-top:5px;word-break:break-all;\">'\r\n  var contentMiddle = '</div><p style=\"margin-top:0;margin-bottom:5px;word-break:break-all;\">'\r\n  var aTagStart = '<a target=\"_blank\" href=\"'\r\n  var emailTagStart = '<a href=\"mailto:'\r\n\r\n  if (popupInfo.fieldInfos !== undefined) {\r\n    for (var i = 0; i < popupInfo.fieldInfos.length; i++) {\r\n      if (popupInfo.fieldInfos[i].visible === true) {\r\n        if (properties[popupInfo.fieldInfos[i].fieldName] === null) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  // + aTagStart\r\n                  // + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + 'none'\r\n                  // + '\">'\r\n                  // + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</p>';\r\n        // if the info is a URL\r\n        } else if (popupInfo.fieldInfos[i].fieldName === 'URL' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'CODE_SEC_1' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'WEBSITE' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'FINAL_LINK_COPY' ||\r\n            popupInfo.fieldInfos[i].fieldName === 'LINK' ||\r\n            // zoning overlays:\r\n            popupInfo.fieldInfos[i].fieldName === 'CODE_SECTION_LINK'\r\n        ) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + aTagStart\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '\">'\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</a></p>';\r\n        // if the info is an email address\r\n        } else if (popupInfo.fieldInfos[i].fieldName.includes('EMAIL')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + emailTagStart\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '\">'\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</a></p>';\r\n        // if the info is a phone number\r\n        } else if (popupInfo.fieldInfos[i].fieldName.includes('PHONE')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + transformPhoneNumber(properties[popupInfo.fieldInfos[i].fieldName])\r\n                  + '</p>';\r\n        // if the info is a date\r\n      } else if (popupInfo.fieldInfos[i].fieldName.includes('DATE')) {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + transformDate(properties[popupInfo.fieldInfos[i].fieldName])\r\n                  + '</p>';\r\n        } else {\r\n          content += contentStart\r\n                  + popupInfo.fieldInfos[i].label\r\n                  + contentMiddle\r\n                  + properties[popupInfo.fieldInfos[i].fieldName]\r\n                  + '</p>';\r\n        }\r\n      }\r\n    }\r\n    content += '</div>';\r\n\r\n  } else if (popupInfo.description !== undefined) {\r\n    // KMLLayer popup\r\n    var descriptionText = popupInfo.description.replace(r, function (s) {\r\n      var m = r.exec(s);\r\n      return properties[m[1]];\r\n    });\r\n    content += descriptionText + '</div>';\r\n  }\r\n\r\n  // if (popupInfo.mediaInfos.length > 0) {\r\n    // It does not support mediaInfos for popup contents.\r\n  // }\r\n\r\n  return content;\r\n}\r\n\r\nexport var Popup = {\r\n  createPopupContent: createPopupContent\r\n};\r\n\r\nexport default Popup;\r\n","import L from 'leaflet';\r\nimport { featureCollection } from './FeatureCollection/FeatureCollection';\r\nimport { csvLayer } from './FeatureCollection/CSVLayer';\r\nimport { kmlLayer } from './FeatureCollection/KMLLayer';\r\nimport { labelMarker } from './Label/LabelMarker';\r\nimport { pointLabelPos } from './Label/PointLabel';\r\nimport { polylineLabelPos } from './Label/PolylineLabel';\r\nimport { polygonLabelPos } from './Label/PolygonLabel';\r\nimport { createPopupContent } from './Popup/Popup';\r\n\r\nexport function operationalLayer (layer, layers, map, params, paneName) {\r\n  // console.log('operationalLayer, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n  return _generateEsriLayer(layer, layers, map, params, paneName);\r\n}\r\n\r\nexport function _generateEsriLayer (layer, layers, map, params, paneName) {\r\n  // console.log('generateEsriLayer: ', layer.title, 'paneName:', paneName, 'layer:', layer);\r\n  var lyr;\r\n  var labels = [];\r\n  var labelsLayer;\r\n  var labelPaneName = paneName + '-label';\r\n  var i, len;\r\n\r\n  if (layer.type === 'Feature Collection' || layer.featureCollection !== undefined) {\r\n    // console.log('create FeatureCollection');\r\n\r\n    map.createPane(labelPaneName);\r\n\r\n    var popupInfo, labelingInfo;\r\n    if (layer.itemId === undefined) {\r\n      for (i = 0, len = layer.featureCollection.layers.length; i < len; i++) {\r\n        if (layer.featureCollection.layers[i].featureSet.features.length > 0) {\r\n          if (layer.featureCollection.layers[i].popupInfo !== undefined && layer.featureCollection.layers[i].popupInfo !== null) {\r\n            popupInfo = layer.featureCollection.layers[i].popupInfo;\r\n          }\r\n          if (layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== undefined && layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo !== null) {\r\n            labelingInfo = layer.featureCollection.layers[i].layerDefinition.drawingInfo.labelingInfo;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    labelsLayer = L.featureGroup(labels);\r\n    var fc = featureCollection(null, {\r\n      data: layer.itemId || layer.featureCollection,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (fc !== undefined) {\r\n          popupInfo = fc.popupInfo;\r\n          labelingInfo = fc.labelingInfo;\r\n        }\r\n        if (popupInfo !== undefined && popupInfo !== null) {\r\n          var popupContent = createPopupContent(popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (labelingInfo !== undefined && labelingInfo !== null) {\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([fc, labelsLayer]);\r\n\r\n    layers.push({ type: 'FC', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer' && layer.layerDefinition !== undefined) {\r\n    var where = '1=1';\r\n    if (layer.layerDefinition.drawingInfo !== undefined) {\r\n      if (layer.layerDefinition.drawingInfo.renderer.type === 'heatmap') {\r\n        // console.log('create HeatmapLayer');\r\n        var gradient = {};\r\n\r\n        layer.layerDefinition.drawingInfo.renderer.colorStops.map(function (stop) {\r\n          // gradient[stop.ratio] = 'rgba(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ',' + (stop.color[3]/255) + ')';\r\n          // gradient[Math.round(stop.ratio*100)/100] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n          gradient[(Math.round(stop.ratio * 100) / 100 + 6) / 7] = 'rgb(' + stop.color[0] + ',' + stop.color[1] + ',' + stop.color[2] + ')';\r\n        });\r\n\r\n        lyr = L.esri.Heat.heatmapFeatureLayer({ // Esri Leaflet 2.0\r\n        // lyr = L.esri.heatmapFeatureLayer({ // Esri Leaflet 1.0\r\n          url: layer.url,\r\n          token: params.token || null,\r\n          minOpacity: 0.5,\r\n          max: layer.layerDefinition.drawingInfo.renderer.maxPixelIntensity,\r\n          blur: layer.layerDefinition.drawingInfo.renderer.blurRadius,\r\n          radius: layer.layerDefinition.drawingInfo.renderer.blurRadius * 1.3,\r\n          gradient: gradient,\r\n          pane: paneName\r\n        });\r\n\r\n        layers.push({ type: 'HL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      } else {\r\n        // console.log('create ArcGISFeatureLayer (with layerDefinition.drawingInfo)');\r\n        var drawingInfo = layer.layerDefinition.drawingInfo;\r\n        drawingInfo.transparency = 100 - (layer.opacity * 100);\r\n        // console.log(drawingInfo.transparency);\r\n\r\n        if (layer.layerDefinition.definitionExpression !== undefined) {\r\n          where = layer.layerDefinition.definitionExpression;\r\n        }\r\n\r\n        map.createPane(labelPaneName);\r\n\r\n        labelsLayer = L.featureGroup(labels);\r\n\r\n        lyr = L.esri.featureLayer({\r\n          url: layer.url,\r\n          where: where,\r\n          token: params.token || null,\r\n          drawingInfo: drawingInfo,\r\n          pane: paneName,\r\n          onEachFeature: function (geojson, l) {\r\n            l.feature.layerName = layer.title.split('_')[1];\r\n            if (layer.popupInfo !== undefined) {\r\n              var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n              // l.bindPopup(popupContent);\r\n              l.feature.popupHtml = popupContent\r\n            }\r\n            if (layer.layerDefinition.drawingInfo.labelingInfo !== undefined && layer.layerDefinition.drawingInfo.labelingInfo !== null) {\r\n              var labelingInfo = layer.layerDefinition.drawingInfo.labelingInfo;\r\n              var coordinates = l.feature.geometry.coordinates;\r\n              var labelPos;\r\n\r\n              if (l.feature.geometry.type === 'Point') {\r\n                labelPos = pointLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'LineString') {\r\n                labelPos = polylineLabelPos(coordinates);\r\n              } else if (l.feature.geometry.type === 'MultiLineString') {\r\n                labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n              } else {\r\n                labelPos = polygonLabelPos(l);\r\n              }\r\n\r\n              var label = labelMarker(labelPos.position, {\r\n                zIndexOffset: 1,\r\n                properties: geojson.properties,\r\n                labelingInfo: labelingInfo,\r\n                offset: labelPos.offset,\r\n                pane: labelPaneName\r\n              });\r\n\r\n              labelsLayer.addLayer(label);\r\n            }\r\n          }\r\n        });\r\n\r\n        lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n        layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n        return lyr;\r\n      }\r\n    } else {\r\n      // console.log('create ArcGISFeatureLayer (without layerDefinition.drawingInfo)');\r\n\r\n      if (layer.layerDefinition.definitionExpression !== undefined) {\r\n        where = layer.layerDefinition.definitionExpression;\r\n      }\r\n\r\n      lyr = L.esri.featureLayer({\r\n        url: layer.url,\r\n        token: params.token || null,\r\n        where: where,\r\n        pane: paneName,\r\n        onEachFeature: function (geojson, l) {\r\n          l.feature.layerName = layer.title.split('_')[1];\r\n          if (layer.popupInfo !== undefined) {\r\n            var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n            // l.bindPopup(popupContent);\r\n            l.feature.popupHtml = popupContent\r\n          }\r\n        }\r\n      });\r\n\r\n      layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n      return lyr;\r\n    }\r\n  } else if (layer.layerType === 'ArcGISFeatureLayer') {\r\n    // console.log('create ArcGISFeatureLayer');\r\n    lyr = L.esri.featureLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (layer.popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n      }\r\n    });\r\n\r\n    layers.push({ type: 'FL', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'CSV') {\r\n    labelsLayer = L.featureGroup(labels);\r\n    lyr = csvLayer(null, {\r\n      url: layer.url,\r\n      layerDefinition: layer.layerDefinition,\r\n      locationInfo: layer.locationInfo,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (layer.popupInfo !== undefined) {\r\n          var popupContent = createPopupContent(layer.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (layer.layerDefinition.drawingInfo.labelingInfo !== undefined && layer.layerDefinition.drawingInfo.labelingInfo !== null) {\r\n          var labelingInfo = layer.layerDefinition.drawingInfo.labelingInfo;\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([lyr, labelsLayer]);\r\n\r\n    layers.push({ type: 'CSV', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'KML') {\r\n    labelsLayer = L.featureGroup(labels);\r\n    var kml = kmlLayer(null, {\r\n      url: layer.url,\r\n      opacity: layer.opacity,\r\n      pane: paneName,\r\n      onEachFeature: function (geojson, l) {\r\n        l.feature.layerName = layer.title.split('_')[1];\r\n        if (kml.popupInfo !== undefined && kml.popupInfo !== null) {\r\n          // console.log(kml.popupInfo);\r\n          var popupContent = createPopupContent(kml.popupInfo, geojson.properties);\r\n          // l.bindPopup(popupContent);\r\n          l.feature.popupHtml = popupContent\r\n        }\r\n        if (kml.labelingInfo !== undefined && kml.labelingInfo !== null) {\r\n          var labelingInfo = kml.labelingInfo;\r\n          var coordinates = l.feature.geometry.coordinates;\r\n          var labelPos;\r\n\r\n          if (l.feature.geometry.type === 'Point') {\r\n            labelPos = pointLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'LineString') {\r\n            labelPos = polylineLabelPos(coordinates);\r\n          } else if (l.feature.geometry.type === 'MultiLineString') {\r\n            labelPos = polylineLabelPos(coordinates[Math.round(coordinates.length / 2)]);\r\n          } else {\r\n            labelPos = polygonLabelPos(l);\r\n          }\r\n\r\n          var label = labelMarker(labelPos.position, {\r\n            zIndexOffset: 1,\r\n            properties: geojson.properties,\r\n            labelingInfo: labelingInfo,\r\n            offset: labelPos.offset,\r\n            pane: labelPaneName\r\n          });\r\n\r\n          labelsLayer.addLayer(label);\r\n        }\r\n      }\r\n    });\r\n\r\n    lyr = L.layerGroup([kml, labelsLayer]);\r\n\r\n    layers.push({ type: 'KML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISImageServiceLayer') {\r\n    // console.log('create ArcGISImageServiceLayer');\r\n    lyr = L.esri.imageMapLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'IML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISMapServiceLayer') {\r\n    lyr = L.esri.dynamicMapLayer({\r\n      url: layer.url,\r\n      token: params.token || null,\r\n      pane: paneName,\r\n      opacity: layer.opacity || 1\r\n    });\r\n\r\n    layers.push({ type: 'DML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'ArcGISTiledMapServiceLayer') {\r\n    try {\r\n      lyr = L.esri.basemapLayer(layer.title);\r\n    } catch (e) {\r\n      lyr = L.esri.tiledMapLayer({\r\n        url: layer.url,\r\n        token: params.token || null\r\n      });\r\n\r\n      L.esri.request(layer.url, {}, function (err, res) {\r\n        if (err) {\r\n          console.log(err);\r\n        } else {\r\n          var maxWidth = (map.getSize().x - 55);\r\n          var tiledAttribution = '<span class=\"esri-attributions\" style=\"line-height:14px; vertical-align: -3px; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; display:inline-block; max-width:' + maxWidth + 'px;\">' + res.copyrightText + '</span>';\r\n          map.attributionControl.addAttribution(tiledAttribution);\r\n        }\r\n      });\r\n    }\r\n\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TML', title: layer.title || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'VectorTileLayer') {\r\n    var keys = {\r\n      'World Street Map (with Relief)': 'StreetsRelief',\r\n      'World Street Map (with Relief) (Mature Support)': 'StreetsRelief',\r\n      'Hybrid Reference Layer': 'Hybrid',\r\n      'Hybrid Reference Layer (Mature Support)': 'Hybrid',\r\n      'World Street Map': 'Streets',\r\n      'World Street Map (Mature Support)': 'Streets',\r\n      'World Street Map (Night)': 'StreetsNight',\r\n      'World Street Map (Night) (Mature Support)': 'StreetsNight',\r\n      'Dark Gray Canvas': 'DarkGray',\r\n      'Dark Gray Canvas (Mature Support)': 'DarkGray',\r\n      'World Topographic Map': 'Topographic',\r\n      'World Topographic Map (Mature Support)': 'Topographic',\r\n      'World Navigation Map': 'Navigation',\r\n      'World Navigation Map (Mature Support)': 'Navigation',\r\n      'Light Gray Canvas': 'Gray',\r\n      'Light Gray Canvas (Mature Support)': 'Gray'\r\n      //'Terrain with Labels': '',\r\n      //'World Terrain with Labels': '',\r\n      //'Light Gray Canvas Reference': '',\r\n      //'Dark Gray Canvas Reference': '',\r\n      //'Dark Gray Canvas Base': '',\r\n      //'Light Gray Canvas Base': ''\r\n    };\r\n\r\n    if (keys[layer.title]) {\r\n      lyr = L.esri.Vector.basemap(keys[layer.title]);\r\n    } else {\r\n      console.error('Unsupported Vector Tile Layer: ', layer);\r\n      lyr = L.featureGroup([]);\r\n    }\r\n\r\n    layers.push({ type: 'VTL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'OpenStreetMap') {\r\n    lyr = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n    });\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'WebTiledLayer') {\r\n    var lyrUrl = _esriWTLUrlTemplateToLeaflet(layer.templateUrl);\r\n    lyr = L.tileLayer(lyrUrl, {\r\n      attribution: layer.copyright\r\n    });\r\n    document.getElementsByClassName('leaflet-tile-pane')[0].style.opacity = layer.opacity || 1;\r\n\r\n    layers.push({ type: 'TL', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else if (layer.layerType === 'WMS') {\r\n    var layerNames = '';\r\n    for (i = 0, len = layer.visibleLayers.length; i < len; i++) {\r\n      layerNames += layer.visibleLayers[i];\r\n      if (i < len - 1) {\r\n        layerNames += ',';\r\n      }\r\n    }\r\n\r\n    lyr = L.tileLayer.wms(layer.url, {\r\n      layers: String(layerNames),\r\n      format: 'image/png',\r\n      transparent: true,\r\n      attribution: layer.copyright\r\n    });\r\n\r\n    layers.push({ type: 'WMS', title: layer.title || layer.id || '', layer: lyr });\r\n\r\n    return lyr;\r\n  } else {\r\n    lyr = L.featureGroup([]);\r\n    console.log('Unsupported Layer: ', layer);\r\n    return lyr;\r\n  }\r\n}\r\n\r\nexport function _esriWTLUrlTemplateToLeaflet (url) {\r\n  var newUrl = url;\r\n\r\n  newUrl = newUrl.replace(/\\{level}/g, '{z}');\r\n  newUrl = newUrl.replace(/\\{col}/g, '{x}');\r\n  newUrl = newUrl.replace(/\\{row}/g, '{y}');\r\n\r\n  return newUrl;\r\n}\r\n\r\nexport var OperationalLayer = {\r\n  operationalLayer: operationalLayer,\r\n  _generateEsriLayer: _generateEsriLayer,\r\n  _esriWTLUrlTemplateToLeaflet: _esriWTLUrlTemplateToLeaflet\r\n};\r\n\r\nexport default OperationalLayer;\r\n","/*\r\n * L.esri.WebMap\r\n * A leaflet plugin to display ArcGIS Web Map. https://github.com/ynunokawa/L.esri.WebMap\r\n * (c) 2016 Yusuke Nunokawa\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var webmap = L.webmap('22c504d229f14c789c5b49ebff38b941', { map: L.map('map') });\r\n * ```\r\n */\r\n\r\nimport { version } from '../package.json';\r\n\r\nimport L from 'leaflet';\r\nimport { operationalLayer } from './OperationalLayer';\r\n\r\nexport var WebMap = L.Evented.extend({\r\n  options: {\r\n    // L.Map\r\n    map: {},\r\n    // access token for secure contents on ArcGIS Online\r\n    token: null,\r\n    // server domain name (default= 'www.arcgis.com')\r\n    server: 'www.arcgis.com'\r\n  },\r\n\r\n  initialize: function (webmapId, options) {\r\n    L.setOptions(this, options);\r\n\r\n    this._map = this.options.map;\r\n    this._token = this.options.token;\r\n    this._server = this.options.server;\r\n    this._webmapId = webmapId;\r\n    this._loaded = false;\r\n    this._metadataLoaded = false;\r\n    this._loadedLayersNum = 0;\r\n    this._layersNum = 0;\r\n\r\n    this.layers = []; // Check the layer types here -> https://github.com/ynunokawa/L.esri.WebMap/wiki/Layer-types\r\n    this.title = ''; // Web Map Title\r\n    this.bookmarks = []; // Web Map Bookmarks -> [{ name: 'Bookmark name', bounds: <L.latLngBounds> }]\r\n    this.portalItem = {}; // Web Map Metadata\r\n\r\n    this.VERSION = version;\r\n\r\n    this._loadWebMapMetaData(webmapId);\r\n    this._loadWebMap(webmapId);\r\n  },\r\n\r\n  _checkLoaded: function () {\r\n    this._loadedLayersNum++;\r\n    if (this._loadedLayersNum === this._layersNum) {\r\n      this._loaded = true;\r\n      this.fire('load');\r\n    }\r\n  },\r\n\r\n  _operationalLayer: function (layer, layers, map, params, paneName) {\r\n    var lyr = operationalLayer(layer, layers, map, params, paneName);\r\n    if (lyr !== undefined && layer.visibility === true) {\r\n      lyr.addTo(map);\r\n    }\r\n  },\r\n\r\n  _loadWebMapMetaData: function (id) {\r\n    // console.log('_loadWebMapMetaData is running, id:', id, 'this._server:', this._server);\r\n    var params = {};\r\n    var map = this._map;\r\n    var webmap = this;\r\n    var webmapMetaDataRequestUrl = 'https://' + this._server + '/sharing/rest/content/items/' + id;\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapMetaDataRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log(error);\r\n      } else {\r\n        // console.log('WebMap MetaData: ', response);\r\n        webmap.portalItem = response;\r\n        webmap.title = response.title;\r\n        webmap._metadataLoaded = true;\r\n        webmap.fire('metadataLoad');\r\n        map.fitBounds([response.extent[0].reverse(), response.extent[1].reverse()]);\r\n      }\r\n    });\r\n  },\r\n\r\n  _loadWebMap: function (id) {\r\n    var map = this._map;\r\n    var layers = this.layers;\r\n    var server = this._server;\r\n    var params = {};\r\n    var webmapRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + id + '/data';\r\n    // console.log('webmapRequestUrl:', webmapRequestUrl, 'this._token:', this._token);\r\n    if (this._token && this._token.length > 0) {\r\n      params.token = this._token;\r\n    }\r\n\r\n    L.esri.request(webmapRequestUrl, params, function (error, response) {\r\n      if (error) {\r\n        console.log('L.esri.request error:', error);\r\n      } else {\r\n        // console.log('WebMap: ', response);\r\n        this._layersNum = response.baseMap.baseMapLayers.length + response.operationalLayers.length;\r\n\r\n        // Add Basemap\r\n        response.baseMap.baseMapLayers.map(function (baseMapLayer) {\r\n          if (baseMapLayer.itemId !== undefined) {\r\n            var itemRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + baseMapLayer.itemId;\r\n            L.esri.request(itemRequestUrl, params, function (err, res) {\r\n              if (err) {\r\n                console.error(error);\r\n              } else {\r\n                console.log(res.access);\r\n                if (res.access !== 'public') {\r\n                  // console.log('in _loadWebMap public')\r\n                  this._operationalLayer(baseMapLayer, layers, map, params);\r\n                } else {\r\n                  // console.log('in _loadWebMap NOT public')\r\n                  this._operationalLayer(baseMapLayer, layers, map, {});\r\n                }\r\n              }\r\n              this._checkLoaded();\r\n            }, this);\r\n          } else {\r\n            this._operationalLayer(baseMapLayer, layers, map, {});\r\n            this._checkLoaded();\r\n          }\r\n        }.bind(this));\r\n\r\n        // Add Operational Layers\r\n        response.operationalLayers.map(function (layer, i) {\r\n          // console.log('response.operationalLayers, layer:', layer);\r\n          var paneName = 'esri-webmap-layer' + i;\r\n          map.createPane(paneName);\r\n          if (layer.itemId !== undefined) {\r\n            // console.log('WebMapLoader.js paneName:', paneName);\r\n            var itemRequestUrl = 'https://' + server + '/sharing/rest/content/items/' + layer.itemId;\r\n            L.esri.request(itemRequestUrl, params, function (err, res) {\r\n              if (err) {\r\n                console.error(error);\r\n              } else {\r\n                console.log(res.access);\r\n                if (res.access !== 'public') {\r\n                  // console.log('inside public, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n                  this._operationalLayer(layer, layers, map, params, paneName);\r\n                } else {\r\n                  // console.log('NOT inside public, layer:', layer, 'layers:', layers, 'map:', map, 'params:', params, 'paneName:', paneName);\r\n                  this._operationalLayer(layer, layers, map, {}, paneName);\r\n                }\r\n              }\r\n              this._checkLoaded();\r\n            }, this);\r\n          } else {\r\n            this._operationalLayer(layer, layers, map, {}, paneName);\r\n            this._checkLoaded();\r\n          }\r\n        }.bind(this));\r\n\r\n        // Add Bookmarks\r\n        if (response.bookmarks !== undefined && response.bookmarks.length > 0) {\r\n          response.bookmarks.map(function (bookmark) {\r\n            // Esri Extent Geometry to L.latLngBounds\r\n            var northEast = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmax, bookmark.extent.ymax));\r\n            var southWest = L.Projection.SphericalMercator.unproject(L.point(bookmark.extent.xmin, bookmark.extent.ymin));\r\n            var bounds = L.latLngBounds(southWest, northEast);\r\n            this.bookmarks.push({ name: bookmark.name, bounds: bounds });\r\n          }.bind(this));\r\n        }\r\n\r\n        //this._loaded = true;\r\n        //this.fire('load');\r\n      }\r\n    }.bind(this));\r\n  }\r\n});\r\n\r\nexport function webMap (webmapId, options) {\r\n  return new WebMap(webmapId, options);\r\n}\r\n\r\nexport default webMap;\r\n","import L from 'leaflet';\n\nexport var Symbol = L.Class.extend({\n  initialize: function (symbolJson, options) {\n    this._symbolJson = symbolJson;\n    this.val = null;\n    this._styles = {};\n    this._isDefault = false;\n    this._layerTransparency = 1;\n    if (options && options.layerTransparency) {\n      this._layerTransparency = 1 - (options.layerTransparency / 100.0);\n    }\n  },\n\n  // the geojson values returned are in points\n  pixelValue: function (pointValue) {\n    return pointValue * 1.333;\n  },\n\n  // color is an array [r,g,b,a]\n  colorValue: function (color) {\n    return 'rgb(' + color[0] + ',' + color[1] + ',' + color[2] + ')';\n  },\n\n  alphaValue: function (color) {\n    var alpha = color[3] / 255.0;\n    return alpha * this._layerTransparency;\n  },\n\n  getSize: function (feature, sizeInfo) {\n    var attr = feature.properties;\n    var field = sizeInfo.field;\n    var size = 0;\n    var featureValue = null;\n\n    if (field) {\n      featureValue = attr[field];\n      var minSize = sizeInfo.minSize;\n      var maxSize = sizeInfo.maxSize;\n      var minDataValue = sizeInfo.minDataValue;\n      var maxDataValue = sizeInfo.maxDataValue;\n      var featureRatio;\n      var normField = sizeInfo.normalizationField;\n      var normValue = attr ? parseFloat(attr[normField]) : undefined;\n\n      if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n        return null;\n      }\n\n      if (!isNaN(normValue)) {\n        featureValue /= normValue;\n      }\n\n      if (minSize !== null && maxSize !== null && minDataValue !== null && maxDataValue !== null) {\n        if (featureValue <= minDataValue) {\n          size = minSize;\n        } else if (featureValue >= maxDataValue) {\n          size = maxSize;\n        } else {\n          featureRatio = (featureValue - minDataValue) / (maxDataValue - minDataValue);\n          size = minSize + (featureRatio * (maxSize - minSize));\n        }\n      }\n      size = isNaN(size) ? 0 : size;\n    }\n    return size;\n  },\n\n  getColor: function (feature, colorInfo) {\n    // required information to get color\n    if (!(feature.properties && colorInfo && colorInfo.field && colorInfo.stops)) {\n      return null;\n    }\n\n    var attr = feature.properties;\n    var featureValue = attr[colorInfo.field];\n    var lowerBoundColor, upperBoundColor, lowerBound, upperBound;\n    var normField = colorInfo.normalizationField;\n    var normValue = attr ? parseFloat(attr[normField]) : undefined;\n    if (featureValue === null || (normField && ((isNaN(normValue) || normValue === 0)))) {\n      return null;\n    }\n\n    if (!isNaN(normValue)) {\n      featureValue /= normValue;\n    }\n\n    if (featureValue <= colorInfo.stops[0].value) {\n      return colorInfo.stops[0].color;\n    }\n    var lastStop = colorInfo.stops[colorInfo.stops.length - 1];\n    if (featureValue >= lastStop.value) {\n      return lastStop.color;\n    }\n\n    // go through the stops to find min and max\n    for (var i = 0; i < colorInfo.stops.length; i++) {\n      var stopInfo = colorInfo.stops[i];\n\n      if (stopInfo.value <= featureValue) {\n        lowerBoundColor = stopInfo.color;\n        lowerBound = stopInfo.value;\n      } else if (stopInfo.value > featureValue) {\n        upperBoundColor = stopInfo.color;\n        upperBound = stopInfo.value;\n        break;\n      }\n    }\n\n    // feature falls between two stops, interplate the colors\n    if (!isNaN(lowerBound) && !isNaN(upperBound)) {\n      var range = upperBound - lowerBound;\n      if (range > 0) {\n        // more weight the further it is from the lower bound\n        var upperBoundColorWeight = (featureValue - lowerBound) / range;\n        if (upperBoundColorWeight) {\n          // more weight the further it is from the upper bound\n          var lowerBoundColorWeight = (upperBound - featureValue) / range;\n          if (lowerBoundColorWeight) {\n            // interpolate the lower and upper bound color by applying the\n            // weights to each of the rgba colors and adding them together\n            var interpolatedColor = [];\n            for (var j = 0; j < 4; j++) {\n              interpolatedColor[j] = Math.round((lowerBoundColor[j] * lowerBoundColorWeight) + (upperBoundColor[j] * upperBoundColorWeight));\n            }\n            return interpolatedColor;\n          } else {\n            // no difference between featureValue and upperBound, 100% of upperBoundColor\n            return upperBoundColor;\n          }\n        } else {\n          // no difference between featureValue and lowerBound, 100% of lowerBoundColor\n          return lowerBoundColor;\n        }\n      }\n    }\n    // if we get to here, none of the cases apply so return null\n    return null;\n  }\n});\n\n// export function symbol (symbolJson) {\n//   return new Symbol(symbolJson);\n// }\n\nexport default Symbol;\n","import L from 'leaflet';\n\nexport var ShapeMarker = L.Path.extend({\n\n  initialize: function (latlng, size, options) {\n    L.setOptions(this, options);\n    this._size = size;\n    this._latlng = L.latLng(latlng);\n    this._svgCanvasIncludes();\n  },\n\n  toGeoJSON: function () {\n    return L.GeoJSON.getFeature(this, {\n      type: 'Point',\n      coordinates: L.GeoJSON.latLngToCoords(this.getLatLng())\n    });\n  },\n\n  _svgCanvasIncludes: function () {\n    // implement in sub class\n  },\n\n  _project: function () {\n    this._point = this._map.latLngToLayerPoint(this._latlng);\n  },\n\n  _update: function () {\n    if (this._map) {\n      this._updatePath();\n    }\n  },\n\n  _updatePath: function () {\n    // implement in sub class\n  },\n\n  setLatLng: function (latlng) {\n    this._latlng = L.latLng(latlng);\n    this.redraw();\n    return this.fire('move', {latlng: this._latlng});\n  },\n\n  getLatLng: function () {\n    return this._latlng;\n  },\n\n  setSize: function (size) {\n    this._size = size;\n    return this.redraw();\n  },\n\n  getSize: function () {\n    return this._size;\n  }\n});\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var CrossMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateCrossMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n\n        ctx.moveTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateCrossMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var crossMarker = function (latlng, size, options) {\n  return new CrossMarker(latlng, size, options);\n};\n\nexport default crossMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var XMarker = ShapeMarker.extend({\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateXMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateXMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'M' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var xMarker = function (latlng, size, options) {\n  return new XMarker(latlng, size, options);\n};\n\nexport default xMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var SquareMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateSquareMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x + offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y - offset);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateSquareMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + (latlng.x + offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + (latlng.y - offset);\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var squareMarker = function (latlng, size, options) {\n  return new SquareMarker(latlng, size, options);\n};\n\nexport default squareMarker;\n","import L from 'leaflet';\nimport { ShapeMarker } from './ShapeMarker';\n\nexport var DiamondMarker = ShapeMarker.extend({\n  options: {\n    fill: true\n  },\n\n  initialize: function (latlng, size, options) {\n    ShapeMarker.prototype.initialize.call(this, latlng, size, options);\n  },\n\n  _updatePath: function () {\n    this._renderer._updateDiamondMarker(this);\n  },\n\n  _svgCanvasIncludes: function () {\n    L.Canvas.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n        var ctx = this._ctx;\n\n        ctx.beginPath();\n\n        ctx.moveTo(latlng.x, latlng.y + offset);\n        ctx.lineTo(latlng.x - offset, latlng.y);\n        ctx.lineTo(latlng.x, latlng.y - offset);\n        ctx.lineTo(latlng.x + offset, latlng.y);\n\n        ctx.closePath();\n\n        this._fillStroke(ctx, layer);\n      }\n    });\n\n    L.SVG.include({\n      _updateDiamondMarker: function (layer) {\n        var latlng = layer._point;\n        var offset = layer._size / 2.0;\n\n        if (L.Browser.vml) {\n          latlng._round();\n          offset = Math.round(offset);\n        }\n\n        var str = 'M' + latlng.x + ',' + (latlng.y + offset) +\n          'L' + (latlng.x - offset) + ',' + latlng.y +\n          'L' + latlng.x + ',' + (latlng.y - offset) +\n          'L' + (latlng.x + offset) + ',' + latlng.y;\n\n        str = str + (L.Browser.svg ? 'z' : 'x');\n\n        this._setPath(layer, str);\n      }\n    });\n  }\n});\n\nexport var diamondMarker = function (latlng, size, options) {\n  return new DiamondMarker(latlng, size, options);\n};\n\nexport default diamondMarker;\n","import L from 'leaflet';\n\nimport pointSymbol from '../Symbols/PointSymbol';\nimport lineSymbol from '../Symbols/LineSymbol';\nimport polygonSymbol from '../Symbols/PolygonSymbol';\n\nexport var Renderer = L.Class.extend({\n  options: {\n    proportionalPolygon: false,\n    clickable: true\n  },\n\n  initialize: function (rendererJson, options) {\n    this._rendererJson = rendererJson;\n    this._pointSymbols = false;\n    this._symbols = [];\n    this._visualVariables = this._parseVisualVariables(rendererJson.visualVariables);\n    L.Util.setOptions(this, options);\n  },\n\n  _parseVisualVariables: function (visualVariables) {\n    var visVars = {};\n    if (visualVariables) {\n      for (var i = 0; i < visualVariables.length; i++) {\n        visVars[visualVariables[i].type] = visualVariables[i];\n      }\n    }\n    return visVars;\n  },\n\n  _createDefaultSymbol: function () {\n    if (this._rendererJson.defaultSymbol) {\n      this._defaultSymbol = this._newSymbol(this._rendererJson.defaultSymbol);\n      this._defaultSymbol._isDefault = true;\n    }\n  },\n\n  _newSymbol: function (symbolJson) {\n    if (symbolJson.type === 'esriSMS' || symbolJson.type === 'esriPMS') {\n      this._pointSymbols = true;\n      return pointSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSLS') {\n      return lineSymbol(symbolJson, this.options);\n    }\n    if (symbolJson.type === 'esriSFS') {\n      return polygonSymbol(symbolJson, this.options);\n    }\n  },\n\n  _getSymbol: function () {\n    // override\n  },\n\n  attachStylesToLayer: function (layer) {\n    if (this._pointSymbols) {\n      layer.options.pointToLayer = L.Util.bind(this.pointToLayer, this);\n    } else {\n      layer.options.style = L.Util.bind(this.style, this);\n      layer._originalStyle = layer.options.style;\n    }\n  },\n\n  pointToLayer: function (geojson, latlng) {\n    var sym = this._getSymbol(geojson);\n    if (sym && sym.pointToLayer) {\n      // right now custom panes are the only option pushed through\n      return sym.pointToLayer(geojson, latlng, this._visualVariables, this.options);\n    }\n    // invisible symbology\n    return L.circleMarker(latlng, {radius: 0, opacity: 0});\n  },\n\n  style: function (feature) {\n    var userStyles;\n    if (this.options.userDefinedStyle) {\n      userStyles = this.options.userDefinedStyle(feature);\n    }\n    // find the symbol to represent this feature\n    var sym = this._getSymbol(feature);\n    if (sym) {\n      return this.mergeStyles(sym.style(feature, this._visualVariables), userStyles);\n    } else {\n      // invisible symbology\n      return this.mergeStyles({opacity: 0, fillOpacity: 0}, userStyles);\n    }\n  },\n\n  mergeStyles: function (styles, userStyles) {\n    var mergedStyles = {};\n    var attr;\n    // copy renderer style attributes\n    for (attr in styles) {\n      if (styles.hasOwnProperty(attr)) {\n        mergedStyles[attr] = styles[attr];\n      }\n    }\n    // override with user defined style attributes\n    if (userStyles) {\n      for (attr in userStyles) {\n        if (userStyles.hasOwnProperty(attr)) {\n          mergedStyles[attr] = userStyles[attr];\n        }\n      }\n    }\n    return mergedStyles;\n  }\n});\n\nexport default Renderer;\n","module.exports = {\n  addDays: require('./add_days/index.js'),\n  addHours: require('./add_hours/index.js'),\n  addISOYears: require('./add_iso_years/index.js'),\n  addMilliseconds: require('./add_milliseconds/index.js'),\n  addMinutes: require('./add_minutes/index.js'),\n  addMonths: require('./add_months/index.js'),\n  addQuarters: require('./add_quarters/index.js'),\n  addSeconds: require('./add_seconds/index.js'),\n  addWeeks: require('./add_weeks/index.js'),\n  addYears: require('./add_years/index.js'),\n  areRangesOverlapping: require('./are_ranges_overlapping/index.js'),\n  closestIndexTo: require('./closest_index_to/index.js'),\n  closestTo: require('./closest_to/index.js'),\n  compareAsc: require('./compare_asc/index.js'),\n  compareDesc: require('./compare_desc/index.js'),\n  differenceInCalendarDays: require('./difference_in_calendar_days/index.js'),\n  differenceInCalendarISOWeeks: require('./difference_in_calendar_iso_weeks/index.js'),\n  differenceInCalendarISOYears: require('./difference_in_calendar_iso_years/index.js'),\n  differenceInCalendarMonths: require('./difference_in_calendar_months/index.js'),\n  differenceInCalendarQuarters: require('./difference_in_calendar_quarters/index.js'),\n  differenceInCalendarWeeks: require('./difference_in_calendar_weeks/index.js'),\n  differenceInCalendarYears: require('./difference_in_calendar_years/index.js'),\n  differenceInDays: require('./difference_in_days/index.js'),\n  differenceInHours: require('./difference_in_hours/index.js'),\n  differenceInISOYears: require('./difference_in_iso_years/index.js'),\n  differenceInMilliseconds: require('./difference_in_milliseconds/index.js'),\n  differenceInMinutes: require('./difference_in_minutes/index.js'),\n  differenceInMonths: require('./difference_in_months/index.js'),\n  differenceInQuarters: require('./difference_in_quarters/index.js'),\n  differenceInSeconds: require('./difference_in_seconds/index.js'),\n  differenceInWeeks: require('./difference_in_weeks/index.js'),\n  differenceInYears: require('./difference_in_years/index.js'),\n  distanceInWords: require('./distance_in_words/index.js'),\n  distanceInWordsStrict: require('./distance_in_words_strict/index.js'),\n  distanceInWordsToNow: require('./distance_in_words_to_now/index.js'),\n  eachDay: require('./each_day/index.js'),\n  endOfDay: require('./end_of_day/index.js'),\n  endOfHour: require('./end_of_hour/index.js'),\n  endOfISOWeek: require('./end_of_iso_week/index.js'),\n  endOfISOYear: require('./end_of_iso_year/index.js'),\n  endOfMinute: require('./end_of_minute/index.js'),\n  endOfMonth: require('./end_of_month/index.js'),\n  endOfQuarter: require('./end_of_quarter/index.js'),\n  endOfSecond: require('./end_of_second/index.js'),\n  endOfToday: require('./end_of_today/index.js'),\n  endOfTomorrow: require('./end_of_tomorrow/index.js'),\n  endOfWeek: require('./end_of_week/index.js'),\n  endOfYear: require('./end_of_year/index.js'),\n  endOfYesterday: require('./end_of_yesterday/index.js'),\n  format: require('./format/index.js'),\n  getDate: require('./get_date/index.js'),\n  getDay: require('./get_day/index.js'),\n  getDayOfYear: require('./get_day_of_year/index.js'),\n  getDaysInMonth: require('./get_days_in_month/index.js'),\n  getDaysInYear: require('./get_days_in_year/index.js'),\n  getHours: require('./get_hours/index.js'),\n  getISODay: require('./get_iso_day/index.js'),\n  getISOWeek: require('./get_iso_week/index.js'),\n  getISOWeeksInYear: require('./get_iso_weeks_in_year/index.js'),\n  getISOYear: require('./get_iso_year/index.js'),\n  getMilliseconds: require('./get_milliseconds/index.js'),\n  getMinutes: require('./get_minutes/index.js'),\n  getMonth: require('./get_month/index.js'),\n  getOverlappingDaysInRanges: require('./get_overlapping_days_in_ranges/index.js'),\n  getQuarter: require('./get_quarter/index.js'),\n  getSeconds: require('./get_seconds/index.js'),\n  getTime: require('./get_time/index.js'),\n  getYear: require('./get_year/index.js'),\n  isAfter: require('./is_after/index.js'),\n  isBefore: require('./is_before/index.js'),\n  isDate: require('./is_date/index.js'),\n  isEqual: require('./is_equal/index.js'),\n  isFirstDayOfMonth: require('./is_first_day_of_month/index.js'),\n  isFriday: require('./is_friday/index.js'),\n  isFuture: require('./is_future/index.js'),\n  isLastDayOfMonth: require('./is_last_day_of_month/index.js'),\n  isLeapYear: require('./is_leap_year/index.js'),\n  isMonday: require('./is_monday/index.js'),\n  isPast: require('./is_past/index.js'),\n  isSameDay: require('./is_same_day/index.js'),\n  isSameHour: require('./is_same_hour/index.js'),\n  isSameISOWeek: require('./is_same_iso_week/index.js'),\n  isSameISOYear: require('./is_same_iso_year/index.js'),\n  isSameMinute: require('./is_same_minute/index.js'),\n  isSameMonth: require('./is_same_month/index.js'),\n  isSameQuarter: require('./is_same_quarter/index.js'),\n  isSameSecond: require('./is_same_second/index.js'),\n  isSameWeek: require('./is_same_week/index.js'),\n  isSameYear: require('./is_same_year/index.js'),\n  isSaturday: require('./is_saturday/index.js'),\n  isSunday: require('./is_sunday/index.js'),\n  isThisHour: require('./is_this_hour/index.js'),\n  isThisISOWeek: require('./is_this_iso_week/index.js'),\n  isThisISOYear: require('./is_this_iso_year/index.js'),\n  isThisMinute: require('./is_this_minute/index.js'),\n  isThisMonth: require('./is_this_month/index.js'),\n  isThisQuarter: require('./is_this_quarter/index.js'),\n  isThisSecond: require('./is_this_second/index.js'),\n  isThisWeek: require('./is_this_week/index.js'),\n  isThisYear: require('./is_this_year/index.js'),\n  isThursday: require('./is_thursday/index.js'),\n  isToday: require('./is_today/index.js'),\n  isTomorrow: require('./is_tomorrow/index.js'),\n  isTuesday: require('./is_tuesday/index.js'),\n  isValid: require('./is_valid/index.js'),\n  isWednesday: require('./is_wednesday/index.js'),\n  isWeekend: require('./is_weekend/index.js'),\n  isWithinRange: require('./is_within_range/index.js'),\n  isYesterday: require('./is_yesterday/index.js'),\n  lastDayOfISOWeek: require('./last_day_of_iso_week/index.js'),\n  lastDayOfISOYear: require('./last_day_of_iso_year/index.js'),\n  lastDayOfMonth: require('./last_day_of_month/index.js'),\n  lastDayOfQuarter: require('./last_day_of_quarter/index.js'),\n  lastDayOfWeek: require('./last_day_of_week/index.js'),\n  lastDayOfYear: require('./last_day_of_year/index.js'),\n  max: require('./max/index.js'),\n  min: require('./min/index.js'),\n  parse: require('./parse/index.js'),\n  setDate: require('./set_date/index.js'),\n  setDay: require('./set_day/index.js'),\n  setDayOfYear: require('./set_day_of_year/index.js'),\n  setHours: require('./set_hours/index.js'),\n  setISODay: require('./set_iso_day/index.js'),\n  setISOWeek: require('./set_iso_week/index.js'),\n  setISOYear: require('./set_iso_year/index.js'),\n  setMilliseconds: require('./set_milliseconds/index.js'),\n  setMinutes: require('./set_minutes/index.js'),\n  setMonth: require('./set_month/index.js'),\n  setQuarter: require('./set_quarter/index.js'),\n  setSeconds: require('./set_seconds/index.js'),\n  setYear: require('./set_year/index.js'),\n  startOfDay: require('./start_of_day/index.js'),\n  startOfHour: require('./start_of_hour/index.js'),\n  startOfISOWeek: require('./start_of_iso_week/index.js'),\n  startOfISOYear: require('./start_of_iso_year/index.js'),\n  startOfMinute: require('./start_of_minute/index.js'),\n  startOfMonth: require('./start_of_month/index.js'),\n  startOfQuarter: require('./start_of_quarter/index.js'),\n  startOfSecond: require('./start_of_second/index.js'),\n  startOfToday: require('./start_of_today/index.js'),\n  startOfTomorrow: require('./start_of_tomorrow/index.js'),\n  startOfWeek: require('./start_of_week/index.js'),\n  startOfYear: require('./start_of_year/index.js'),\n  startOfYesterday: require('./start_of_yesterday/index.js'),\n  subDays: require('./sub_days/index.js'),\n  subHours: require('./sub_hours/index.js'),\n  subISOYears: require('./sub_iso_years/index.js'),\n  subMilliseconds: require('./sub_milliseconds/index.js'),\n  subMinutes: require('./sub_minutes/index.js'),\n  subMonths: require('./sub_months/index.js'),\n  subQuarters: require('./sub_quarters/index.js'),\n  subSeconds: require('./sub_seconds/index.js'),\n  subWeeks: require('./sub_weeks/index.js'),\n  subYears: require('./sub_years/index.js')\n}\n"],"names":["pointsEqual","a","b","i","length","closeRing","coordinates","push","ringIsClockwise","ringToTest","pt2","total","rLength","pt1","vertexIntersectsVertex","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","arrayIntersectsArray","j","coordinatesContainPoint","point","contains","l","coordinatesContainCoordinates","outer","inner","intersects","convertRingsToGeoJSON","rings","x","outerRing","hole","outerRings","holes","r","ring","slice","polygon","uncontainedHoles","pop","contained","reverse","type","shallowClone","obj","target","hasOwnProperty","arcgisToGeoJSON","arcgis","idAttribute","geojson","y","points","paths","geometry","attributes","properties","id","OBJECTID","FID","JSON","stringify","pointSymbol","symbolJson","options","PointSymbol","lineSymbol","LineSymbol","polygonSymbol","PolygonSymbol","classBreaksRenderer","rendererJson","ClassBreaksRenderer","uniqueValueRenderer","UniqueValueRenderer","simpleRenderer","SimpleRenderer","setRenderer","layerDefinition","layer","rend","rendererInfo","drawingInfo","renderer","pane","transparency","layerTransparency","style","userDefinedStyle","checkForProportionalSymbols","geometryType","_hasProportionalSymbols","_createPointLayer","attachStylesToLayer","_pointLayer","proportionalPolygon","console","log","backgroundFillSymbol","classBreakInfos","sym","symbol","featureCollection","FeatureCollection","csvLayer","CSVLayer","kmlLayer","KMLLayer","labelIcon","LabelIcon","labelMarker","latlng","LabelMarker","pointLabelPos","labelPos","position","offset","polylineLabelPos","centralKey","Math","round","polygonLabelPos","getBounds","getCenter","transformPhoneNumber","value","s2","replace","m","match","transformDate","datefns.format","createPopupContent","popupInfo","titleText","content","undefined","title","s","exec","contentStart","contentMiddle","fieldInfos","visible","fieldName","label","includes","description","descriptionText","operationalLayer","layers","map","params","paneName","_generateEsriLayer","lyr","labelsLayer","len","labels","labelPaneName","createPane","labelingInfo","itemId","featureSet","features","L","featureGroup","fc","data","opacity","onEachFeature","feature","layerName","split","popupContent","popupHtml","zIndexOffset","addLayer","layerGroup","layerType","where","gradient","colorStops","stop","ratio","color","esri","Heat","heatmapFeatureLayer","url","token","minOpacity","max","maxPixelIntensity","blur","blurRadius","radius","definitionExpression","featureLayer","locationInfo","kml","imageMapLayer","dynamicMapLayer","basemapLayer","e","tiledMapLayer","request","err","res","maxWidth","getSize","tiledAttribution","copyrightText","attributionControl","addAttribution","document","getElementsByClassName","keys","World Street Map (with Relief)","World Street Map (with Relief) (Mature Support)","Hybrid Reference Layer","Hybrid Reference Layer (Mature Support)","World Street Map","World Street Map (Mature Support)","World Street Map (Night)","World Street Map (Night) (Mature Support)","Dark Gray Canvas","Dark Gray Canvas (Mature Support)","World Topographic Map","World Topographic Map (Mature Support)","World Navigation Map","World Navigation Map (Mature Support)","Light Gray Canvas","Light Gray Canvas (Mature Support)","Vector","basemap","error","tileLayer","attribution","lyrUrl","_esriWTLUrlTemplateToLeaflet","templateUrl","copyright","layerNames","visibleLayers","wms","String","format","transparent","newUrl","webMap","webmapId","WebMap","Symbol","Class","extend","initialize","this","_symbolJson","val","_styles","_isDefault","_layerTransparency","pixelValue","pointValue","colorValue","alphaValue","sizeInfo","attr","field","size","featureValue","featureRatio","minSize","maxSize","minDataValue","maxDataValue","normField","normalizationField","normValue","parseFloat","isNaN","getColor","colorInfo","stops","lowerBoundColor","upperBoundColor","lowerBound","upperBound","lastStop","stopInfo","range","upperBoundColorWeight","lowerBoundColorWeight","interpolatedColor","ShapeMarker","Path","setOptions","_size","_latlng","latLng","_svgCanvasIncludes","toGeoJSON","GeoJSON","getFeature","latLngToCoords","getLatLng","_project","_point","_map","latLngToLayerPoint","_update","_updatePath","setLatLng","redraw","fire","setSize","CrossMarker","prototype","call","_renderer","_updateCrossMarker","Canvas","include","ctx","_ctx","beginPath","moveTo","lineTo","_fillStroke","SVG","Browser","vml","_round","str","_setPath","crossMarker","XMarker","_updateXMarker","xMarker","SquareMarker","fill","_updateSquareMarker","closePath","svg","squareMarker","DiamondMarker","_updateDiamondMarker","diamondMarker","statics","MARKERTYPES","serviceUrl","imageUrl","substr","sanitize","_iconUrl","imageData","contentType","_icons","icon","_createIcon","_fillStyles","text","ex","outline","stroke","weight","width","fillColor","fillOpacity","height","xOffset","yOffset","xoffset","yoffset","iconUrl","iconSize","iconAnchor","toString","_getIcon","pointToLayer","visualVariables","calculatedSize","layerOptions","marker","circleMarker","LINETYPES","lineCap","lineJoin","dashValues","dashArray","join","POLYGONTYPES","_lineStyles","styleAttr","indexOf","Renderer","clickable","_rendererJson","_pointSymbols","_symbols","_visualVariables","_parseVisualVariables","Util","visVars","_createDefaultSymbol","defaultSymbol","_defaultSymbol","_newSymbol","_getSymbol","bind","_originalStyle","userStyles","mergeStyles","styles","mergedStyles","_field","normalizationType","_normalizationField","_createSymbols","classbreaks","classMaxValue","sort","_maxValue","field1","uniques","uniqueValueInfos","fieldDelimiter","field2","val2","val3","field3","_createSymbol","_layers","_getFeatureCollection","_parseFeatureCollection","index","objectIdField","extent","spatialReference","wkid","_projTo4326","_featureCollectionToGeoJSON","addData","projFeatures","mercatorToLatlng","k","f","Projection","SphericalMercator","unproject","lng","lat","plen","pathlen","pathslen","ringlen","ringslen","geojsonFeatureCollection","featuresArray","_parseCSV","omnivore","csv","latfield","latitudeFieldName","lonfield","longitudeFieldName","_getKML","requestUrl","DivIcon","className","createIcon","oldIcon","div","tagName","createElement","innerHTML","fontSize","fontWeight","textTransform","textAlign","whiteSpace","bgPos","backgroundPosition","_setIconStyles","Marker","labelText","_createLabelText","_setLabelIcon","labelExpression","setIcon","module","exports","addDays","require","addHours","addISOYears","addMilliseconds","addMinutes","addMonths","addQuarters","addSeconds","addWeeks","addYears","areRangesOverlapping","closestIndexTo","closestTo","compareAsc","compareDesc","differenceInCalendarDays","differenceInCalendarISOWeeks","differenceInCalendarISOYears","differenceInCalendarMonths","differenceInCalendarQuarters","differenceInCalendarWeeks","differenceInCalendarYears","differenceInDays","differenceInHours","differenceInISOYears","differenceInMilliseconds","differenceInMinutes","differenceInMonths","differenceInQuarters","differenceInSeconds","differenceInWeeks","differenceInYears","distanceInWords","distanceInWordsStrict","distanceInWordsToNow","eachDay","endOfDay","endOfHour","endOfISOWeek","endOfISOYear","endOfMinute","endOfMonth","endOfQuarter","endOfSecond","endOfToday","endOfTomorrow","endOfWeek","endOfYear","endOfYesterday","getDate","getDay","getDayOfYear","getDaysInMonth","getDaysInYear","getHours","getISODay","getISOWeek","getISOWeeksInYear","getISOYear","getMilliseconds","getMinutes","getMonth","getOverlappingDaysInRanges","getQuarter","getSeconds","getTime","getYear","isAfter","isBefore","isDate","isEqual","isFirstDayOfMonth","isFriday","isFuture","isLastDayOfMonth","isLeapYear","isMonday","isPast","isSameDay","isSameHour","isSameISOWeek","isSameISOYear","isSameMinute","isSameMonth","isSameQuarter","isSameSecond","isSameWeek","isSameYear","isSaturday","isSunday","isThisHour","isThisISOWeek","isThisISOYear","isThisMinute","isThisMonth","isThisQuarter","isThisSecond","isThisWeek","isThisYear","isThursday","isToday","isTomorrow","isTuesday","isValid","isWednesday","isWeekend","isWithinRange","isYesterday","lastDayOfISOWeek","lastDayOfISOYear","lastDayOfMonth","lastDayOfQuarter","lastDayOfWeek","lastDayOfYear","min","parse","setDate","setDay","setDayOfYear","setHours","setISODay","setISOWeek","setISOYear","setMilliseconds","setMinutes","setMonth","setQuarter","setSeconds","setYear","startOfDay","startOfHour","startOfISOWeek","startOfISOYear","startOfMinute","startOfMonth","startOfQuarter","startOfSecond","startOfToday","startOfTomorrow","startOfWeek","startOfYear","startOfYesterday","subDays","subHours","subISOYears","subMilliseconds","subMinutes","subMonths","subQuarters","subSeconds","subWeeks","subYears","Evented","server","_token","_server","_webmapId","_loaded","_metadataLoaded","_loadedLayersNum","_layersNum","bookmarks","portalItem","VERSION","_loadWebMapMetaData","_loadWebMap","_checkLoaded","_operationalLayer","visibility","addTo","webmap","webmapMetaDataRequestUrl","response","fitBounds","webmapRequestUrl","baseMap","baseMapLayers","operationalLayers","baseMapLayer","itemRequestUrl","access","bookmark","northEast","xmax","ymax","southWest","xmin","ymin","bounds","latLngBounds","name"],"mappings":"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"}